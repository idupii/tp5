define("kindeditor",function(require,exports,module){!function(w,i){function Z(a){return a?"[object Array]"===Object.prototype.toString.call(a):!1}function wa(a){return a?"[object Function]"===Object.prototype.toString.call(a):!1}function J(a,c){for(var h=0,d=c.length;d>h;h++)if(a===c[h])return h;return-1}function m(a,c){if(Z(a))for(var h=0,d=a.length;d>h&&c.call(a[h],h,a[h])!==!1;h++);else for(h in a)if(a.hasOwnProperty(h)&&c.call(a[h],h,a[h])===!1)break}function B(a){return a.replace(/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"")}function xa(a,c,h){return h=h===i?",":h,(h+c+h).indexOf(h+a+h)>=0}function s(a,c){return c=c||"px",a&&/^\d+$/.test(a)?a+c:a}function t(a){var c;return a&&(c=/(\d+)/.exec(a))?parseInt(c[1],10):0}function C(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function fa(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")}function ga(a){var c=a.split("-"),a="";return m(c,function(c,d){a+=c>0?d.charAt(0).toUpperCase()+d.substr(1):d}),a}function ya(a){function c(a){return a=parseInt(a,10).toString(16).toUpperCase(),a.length>1?a:"0"+a}return a.replace(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/gi,function(a,d,e,h){return"#"+c(d)+c(e)+c(h)})}function u(a,c){var e,c=c===i?",":c,h={},d=Z(a)?a:a.split(c);return m(d,function(a,c){if(e=/^(\d+)\.\.(\d+)$/.exec(c))for(var d=parseInt(e[1],10);d<=parseInt(e[2],10);d++)h[d.toString()]=!0;else h[c]=!0}),h}function Ja(a,c){return Array.prototype.slice.call(a,c||0)}function l(a,c){return a===i?c:a}function E(a,c,h){h||(h=c,c=null);var d;if(c){var e=function(){};e.prototype=c.prototype,d=new e,m(h,function(a,c){d[a]=c})}else d=h;d.constructor=a,a.prototype=d,a.parent=c?c.prototype:null}function eb(a){var b;if((b=/\{[\s\S]*\}|\[[\s\S]*\]/.exec(a))&&(a=b[0]),b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b.lastIndex=0,b.test(a)&&(a=a.replace(b,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+a+")");throw"JSON parse error"}function Rb(a,c,h){a.addEventListener?a.addEventListener(c,h,fb):a.attachEvent&&a.attachEvent("on"+c,h)}function za(a,c,h){a.removeEventListener?a.removeEventListener(c,h,fb):a.detachEvent&&a.detachEvent("on"+c,h)}function gb(a,c){this.init(a,c)}function hb(a){try{delete a[$]}catch(c){a.removeAttribute&&a.removeAttribute($)}}function aa(a,c,h){if(c.indexOf(",")>=0)m(c.split(","),function(){aa(a,this,h)});else{var d=a[$]||null;d||(a[$]=++ib,d=ib),v[d]===i&&(v[d]={});var e=v[d][c];e&&e.length>0?za(a,c,e[0]):(v[d][c]=[],v[d].el=a),e=v[d][c],0===e.length&&(e[0]=function(c){var h=c?new gb(a,c):i;m(e,function(c,d){c>0&&d&&d.call(a,h)})}),J(h,e)<0&&e.push(h),Rb(a,c,e[0])}}function ha(a,c,h){if(c&&c.indexOf(",")>=0)m(c.split(","),function(){ha(a,this,h)});else{var d=a[$]||null;if(d)if(c===i)d in v&&(m(v[d],function(c,h){"el"!=c&&h.length>0&&za(a,c,h[0])}),delete v[d],hb(a));else if(v[d]){var e=v[d][c];if(e&&e.length>0){h===i?(za(a,c,e[0]),delete v[d][c]):(m(e,function(a,c){a>0&&c===h&&e.splice(a,1)}),1==e.length&&(za(a,c,e[0]),delete v[d][c]));var g=0;m(v[d],function(){g++}),2>g&&(delete v[d],hb(a))}}}}function jb(a,c){if(c.indexOf(",")>=0)m(c.split(","),function(){jb(a,this)});else{var h=a[$]||null;if(h){var d=v[h][c];v[h]&&d&&d.length>0&&d[0]()}}}function Ka(a,c,h){c=/^\d{2,}$/.test(c)?c:c.toUpperCase().charCodeAt(0),aa(a,"keydown",function(d){d.ctrlKey&&d.which==c&&!d.shiftKey&&!d.altKey&&(h.call(a),d.stop())})}function ba(a){for(var d,c={},h=/\s*([\w\-]+)\s*:([^;]*)(;|$)/g;d=h.exec(a);){var e=B(d[1].toLowerCase());d=B(ya(d[2])),c[e]=d}return c}function I(a){for(var d,c={},h=/\s+(?:([\w\-:]+)|(?:([\w\-:]+)=([^\s"'<>]+))|(?:([\w\-:"]+)="([^"]*)")|(?:([\w\-:"]+)='([^']*)'))(?=(?:\s|\/|>)+)/g;d=h.exec(a);){var e=(d[1]||d[2]||d[4]||d[6]).toLowerCase();c[e]=(d[2]?d[3]:d[4]?d[5]:d[7])||""}return c}function Sb(a,c){return a=/\s+class\s*=/.test(a)?a.replace(/(\s+class=["']?)([^"']*)(["']?[\s>])/,function(a,d,e,h){return(" "+e+" ").indexOf(" "+c+" ")<0?""===e?d+c+h:d+e+" "+c+h:a}):a.substr(0,a.length-1)+' class="'+c+'">'}function Tb(a){var c="";return m(ba(a),function(a,d){c+=a+":"+d+";"}),c}function ia(a,c,h,d){function e(a){for(var a=a.split("/"),c=[],h=0,d=a.length;d>h;h++){var e=a[h];".."==e?c.length>0&&c.pop():""!==e&&"."!=e&&c.push(e)}return"/"+c.join("/")}function g(c,h){if(a.substr(0,c.length)===c){for(var e=[],b=0;h>b;b++)e.push("..");return b=".",e.length>0&&(b+="/"+e.join("/")),"/"==d&&(b+="/"),b+a.substr(c.length)}return(f=/^(.*)\//.exec(c))?g(f[1],++h):void 0}if(c=l(c,"").toLowerCase(),"data:"!=a.substr(0,5)&&(a=a.replace(/([^:])\/\//g,"$1/")),J(c,["absolute","relative","domain"])<0)return a;if(h=h||location.protocol+"//"+location.host,d===i)var b=location.pathname.match(/^(\/.*)\//),d=b?b[1]:"";var f;if(f=/^(\w+:\/\/[^\/]*)/.exec(a)){if(f[1]!==h)return a}else if(/^\w+:/.test(a))return a;return/^\//.test(a)?a=h+e(a.substr(1)):/^\w+:\/\//.test(a)||(a=h+e(d+"/"+a)),"relative"===c?a=g(h+d,0).substr(2):"absolute"===c&&a.substr(0,h.length)===h&&(a=a.substr(h.length)),a}function U(a,c,h,d,e){null==a&&(a="");var h=h||"",d=l(d,!1),e=l(e,"	"),g="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),a=a.replace(/(<(?:pre|pre\s[^>]*)>)([\s\S]*?)(<\/pre>)/gi,function(a,c,h,d){return c+h.replace(/<(?:br|br\s[^>]*)>/gi,"\n")+d}),a=a.replace(/<(?:br|br\s[^>]*)\s*\/?>\s*<\/p>/gi,"</p>"),a=a.replace(/(<(?:p|p\s[^>]*)>)\s*(<\/p>)/gi,"$1<br />$2"),a=a.replace(/\u200B/g,""),a=a.replace(/\u00A9/g,"&copy;"),a=a.replace(/\u00AE/g,"&reg;"),a=a.replace(/<[^>]+/g,function(a){return a.replace(/\s+/g," ")}),b={};c&&(m(c,function(a,c){for(var h=a.split(","),d=0,e=h.length;e>d;d++)b[h[d]]=u(c)}),b.script||(a=a.replace(/(<(?:script|script\s[^>]*)>)([\s\S]*?)(<\/script>)/gi,"")),b.style||(a=a.replace(/(<(?:style|style\s[^>]*)>)([\s\S]*?)(<\/style>)/gi,"")));var f=[],a=a.replace(/(\s*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:"]+="[^"]*")|(?:\s+[\w\-:"]+='[^']*'))*)(\/)?>(\s*)/g,function(a,n,q,r,v,y,i){var n=n||"",q=q||"",l=r.toLowerCase(),o=v||"",r=y?" "+y:"",i=i||"";if(c&&!b[l])return"";if(""===r&&kb[l]&&(r=" /"),lb[l]&&(n&&(n=" "),i&&(i=" ")),La[l]&&(q?i="\n":n="\n"),d&&"br"==l&&(i="\n"),mb[l]&&!La[l])if(d){for(q&&f.length>0&&f[f.length-1]===l?f.pop():f.push(l),i=n="\n",v=0,y=q?f.length:f.length-1;y>v;v++)n+=e,q||(i+=e);r?f.pop():q||(i+=e)}else n=i="";if(""!==o){var k=I(a);if("font"===l){var C={},w="";m(k,function(a,c){"color"===a&&(C.color=c,delete k[a]),"size"===a&&(C["font-size"]=g[parseInt(c,10)-1]||"",delete k[a]),"face"===a&&(C["font-family"]=c,delete k[a]),"style"===a&&(w=c)}),w&&!/;$/.test(w)&&(w+=";"),m(C,function(a,c){""!==c&&(/\s/.test(c)&&(c="'"+c+"'"),w+=a+":"+c+";")}),k.style=w}m(k,function(a,d){if(Ub[a]&&(k[a]=a),J(a,["src","href"])>=0&&(k[a]=ia(d,h)),(c&&"style"!==a&&!b[l]["*"]&&!b[l][a]||"body"===l&&"contenteditable"===a||/^kindeditor_\d+$/.test(a))&&delete k[a],"style"===a&&""!==d){var e=ba(d);m(e,function(a){c&&!b[l].style&&!b[l]["."+a]&&delete e[a]});var g="";m(e,function(a,c){g+=a+":"+c+";"}),k.style=g}}),o="",m(k,function(a,c){"style"===a&&""===c||(c=c.replace(/"/g,"&quot;"),o+=" "+a+'="'+c+'"')})}return"font"===l&&(l="span"),n+"<"+q+l+o+r+">"+i}),a=a.replace(/(<(?:pre|pre\s[^>]*)>)([\s\S]*?)(<\/pre>)/gi,function(a,c,h,d){return c+h.replace(/\n/g,'<span id="__kindeditor_pre_newline__">\n')+d}),a=a.replace(/\n\s*\n/g,"\n"),a=a.replace(/<span id="__kindeditor_pre_newline__">\n/g,"\n");return B(a)}function nb(a,c){return a=a.replace(/<meta[\s\S]*?>/gi,"").replace(/<![\s\S]*?>/gi,"").replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<w:[^>]+>[\s\S]*?<\/w:[^>]+>/gi,"").replace(/<o:[^>]+>[\s\S]*?<\/o:[^>]+>/gi,"").replace(/<xml>[\s\S]*?<\/xml>/gi,"").replace(/<(?:table|td)[^>]*>/gi,function(a){return a.replace(/border-bottom:([#\w\s]+)/gi,"border:$1")}),U(a,c)}function ob(a){return/\.(rm|rmvb)(\?|$)/i.test(a)?"audio/x-pn-realaudio-plugin":/\.(swf|flv)(\?|$)/i.test(a)?"application/x-shockwave-flash":"video/x-ms-asf-plugin"}function pb(a){return I(unescape(a))}function Ma(a){var c="<embed ";return m(a,function(a,d){c+=a+'="'+d+'" '}),c+="/>"}function qb(a,c){var h=c.width,d=c.height,e=c.type||ob(c.src),g=Ma(c),b="";return/\D/.test(h)?b+="width:"+h+";":h>0&&(b+="width:"+h+"px;"),/\D/.test(d)?b+="height:"+d+";":d>0&&(b+="height:"+d+"px;"),h=/realaudio/i.test(e)?"ke-rm":/flash/i.test(e)?"ke-flash":"ke-media",h='<img class="'+h+'" src="'+a+'" ',""!==b&&(h+='style="'+b+'" '),h+='data-ke-tag="'+escape(g)+'" alt="" />'}function Aa(a,c){if(9==a.nodeType&&9!=c.nodeType)return!0;for(;c=c.parentNode;)if(c==a)return!0;return!1}function Ba(a,c){var c=c.toLowerCase(),h=null;if(Vb||"script"==a.nodeName.toLowerCase())try{h=a.getAttribute(c,2)}catch(e){h=a.getAttribute(c,1)}else{var d=a.ownerDocument.createElement("div");d.appendChild(a.cloneNode(!1)),d=I(fa(d.innerHTML)),c in d&&(h=d[c])}return"style"===c&&null!==h&&(h=Tb(h)),h}function Ca(a,c){function h(a){return"string"!=typeof a?a:a.replace(/([^\w\-])/g,"\\$1")}function d(a,c){return"*"===a||a.toLowerCase()===h(c.toLowerCase())}function e(a,c,h){var e=[];return(a=(h.ownerDocument||h).getElementById(a.replace(/\\/g,"")))&&d(c,a.nodeName)&&Aa(h,a)&&e.push(a),e}function g(a,c,h){var g,f,b,e=h.ownerDocument||h,v=[];if(h.getElementsByClassName)for(e=h.getElementsByClassName(a.replace(/\\/g,"")),g=0,f=e.length;f>g;g++)b=e[g],d(c,b.nodeName)&&v.push(b);else if(e.querySelectorAll)for(e=e.querySelectorAll(("#document"!==h.nodeName?h.nodeName+" ":"")+c+"."+a),g=0,f=e.length;f>g;g++)b=e[g],Aa(h,b)&&v.push(b);else for(e=h.getElementsByTagName(c),a=" "+a+" ",g=0,f=e.length;f>g;g++)b=e[g],1==b.nodeType&&(c=b.className)&&(" "+c+" ").indexOf(a)>-1&&v.push(b);return v}function b(a,c,d,e){for(var g=[],d=e.getElementsByTagName(d),b=0,f=d.length;f>b;b++)e=d[b],1==e.nodeType&&(null===c?null!==Ba(e,a)&&g.push(e):c===h(Ba(e,a))&&g.push(e));return g}function f(a,c){var h,v=[],y=(h=/^((?:\\.|[^.#\s\[<>])+)/.exec(a))?h[1]:"*";if(h=/#((?:[\w\-]|\\.)+)$/.exec(a))v=e(h[1],y,c);else if(h=/\.((?:[\w\-]|\\.)+)$/.exec(a))v=g(h[1],y,c);else if(h=/\[((?:[\w\-]|\\.)+)\]/.exec(a))v=b(h[1].toLowerCase(),null,y,c);else if(h=/\[((?:[\w\-]|\\.)+)\s*=\s*['"]?((?:\\.|[^'"]+)+)['"]?\]/.exec(a)){if(v=h[1].toLowerCase(),h=h[2],"id"===v)y=e(h,y,c);else if("class"===v)y=g(h,y,c);else if("name"===v){v=[],h=(c.ownerDocument||c).getElementsByName(h.replace(/\\/g,""));for(var n,r=0,q=h.length;q>r;r++)n=h[r],d(y,n.nodeName)&&Aa(c,n)&&null!==n.getAttribute("name")&&v.push(n);y=v}else y=b(v,h,y,c);v=y}else for(y=c.getElementsByTagName(y),n=0,r=y.length;r>n;n++)h=y[n],1==h.nodeType&&v.push(h);return v}var v=a.split(",");if(v.length>1){var n=[];return m(v,function(){m(Ca(this,c),function(){J(this,n)<0&&n.push(this)})}),n}for(var q,c=c||document,v=[],r=/((?:\\.|[^\s>])+|[\s>])/g;q=r.exec(a);)" "!==q[1]&&v.push(q[1]);if(q=[],1==v.length)return f(v[0],c);var y,l,i,o,p,k,C,w,s,t,r=!1;for(k=0,lenth=v.length;lenth>k;k++)if(y=v[k],">"===y)r=!0;else{if(k>0){for(l=[],C=0,s=q.length;s>C;C++)for(o=q[C],i=f(y,o),w=0,t=i.length;t>w;w++)p=i[w],r?o===p.parentNode&&l.push(p):l.push(p);q=l}else q=f(y,c);if(0===q.length)return[]}return q}function V(a){return a?a.ownerDocument||a.document||a:document}function W(a){return a?(a=V(a),a.parentWindow||a.defaultView):w}function Wb(a,c){if(1==a.nodeType){var h=V(a);try{a.innerHTML='<img id="__kindeditor_temp_tag__" width="0" height="0" style="display:none;" />'+c;var d=h.getElementById("__kindeditor_temp_tag__");d.parentNode.removeChild(d)}catch(e){f(a).empty(),f("@"+c,h).each(function(){a.appendChild(this)})}}}function Na(a,c,h){o&&8>A&&"class"==c.toLowerCase()&&(c="className"),a.setAttribute(c,""+h)}function Oa(a){return a&&a.nodeName?a.nodeName.toLowerCase():""}function Xb(a,c){var h=W(a),d=ga(c),e="";return h.getComputedStyle?(h=h.getComputedStyle(a,null),e=h[d]||h.getPropertyValue(c)||a.style[d]):a.currentStyle&&(e=a.currentStyle[d]||a.style[d]),e}function G(a){return a=a||document,P?a.body:a.documentElement}function ca(a){var c,a=a||document;return o||Yb||Pa?(c=G(a).scrollLeft,a=G(a).scrollTop):(c=W(a).scrollX,a=W(a).scrollY),{x:c,y:a}}function D(a){this.init(a)}function rb(a){return a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a}function Qa(a,c,h){function d(d,e,g){var b,v=d.nodeValue.length;if(c&&(b=d.cloneNode(!0),b=e>0?b.splitText(e):b,v>g&&b.splitText(g-e)),h){var n=d;e>0&&(n=d.splitText(e),a.setStart(d,e)),v>g&&(d=n.splitText(g-e),a.setEnd(d,0)),f.push(n)}return b}function e(){h&&a.up().collapse(!0);for(var c=0,d=f.length;d>c;c++){var e=f[c];e.parentNode&&e.parentNode.removeChild(e)}}function g(e,l){for(var o,i=e.firstChild;i;){if(o=new M(b).selectNode(i),n=o.compareBoundaryPoints(ka,a),n>=0&&0>=q&&(q=o.compareBoundaryPoints(la,a)),q>=0&&0>=r&&(r=o.compareBoundaryPoints(da,a)),r>=0&&0>=m&&(m=o.compareBoundaryPoints(ma,a)),m>=0)return!1;if(o=i.nextSibling,n>0)if(1==i.nodeType)if(q>=0&&0>=r)c&&l.appendChild(i.cloneNode(!0)),h&&f.push(i);else{var p;if(c&&(p=i.cloneNode(!1),l.appendChild(p)),g(i,p)===!1)return!1}else if(3==i.nodeType&&(i=i==v.startContainer?d(i,v.startOffset,i.nodeValue.length):i==v.endContainer?d(i,0,v.endOffset):d(i,0,i.nodeValue.length),c))try{l.appendChild(i)}catch(y){}i=o}}var b=a.doc,f=[],v=a.cloneRange().down(),n=-1,q=-1,r=-1,m=-1,l=a.commonAncestor(),i=b.createDocumentFragment();if(3==l.nodeType)return l=d(l,a.startOffset,a.endOffset),c&&i.appendChild(l),e(),c?i:a;g(l,i),h&&a.up().collapse(!0);for(var l=0,o=f.length;o>l;l++){var p=f[l];p.parentNode&&p.parentNode.removeChild(p)}return c?i:a}function na(a,c){for(var h=c;h;){var d=f(h);if("marquee"==d.name||"select"==d.name)return;h=h.parentNode}try{a.moveToElementText(c)}catch(e){}}function sb(a,c){var h=a.parentElement().ownerDocument,d=a.duplicate();d.collapse(c);var e=d.parentElement(),g=e.childNodes;if(0===g.length)return{node:e.parentNode,offset:f(e).index()};var b=h,v=0,y=-1,n=a.duplicate();na(n,e);for(var q=0,r=g.length;r>q;q++){var i=g[q],y=n.compareEndPoints("StartToStart",d);if(0===y)return{node:i.parentNode,offset:q};if(1==i.nodeType){var m,l=a.duplicate(),o=f(i),p=i;o.isControl()&&(m=h.createElement("span"),o.after(m),p=m,v+=o.text().replace(/\r\n|\n|\r/g,"").length),na(l,p),n.setEndPoint("StartToEnd",l),y>0?v+=l.text.replace(/\r\n|\n|\r/g,"").length:v=0,m&&f(m).remove()}else 3==i.nodeType&&(n.moveStart("character",i.nodeValue.length),v+=i.nodeValue.length);0>y&&(b=i)}if(0>y&&1==b.nodeType)return{node:e,offset:f(e.lastChild).index()+1};if(y>0)for(;b.nextSibling&&1==b.nodeType;)b=b.nextSibling;if(n=a.duplicate(),na(n,e),n.setEndPoint("StartToEnd",d),v-=n.text.replace(/\r\n|\n|\r/g,"").length,y>0&&3==b.nodeType)for(h=b.previousSibling;h&&3==h.nodeType;)v-=h.nodeValue.length,h=h.previousSibling;return{node:b,offset:v}}function tb(a,c){var h=a.ownerDocument||a,d=h.body.createTextRange();if(h==a)return d.collapse(!0),d;if(1==a.nodeType&&a.childNodes.length>0){var g,e=a.childNodes;if(0===c?(g=e[0],e=!0):(g=e[c-1],e=!1),!g)return d;if("head"===f(g).name)return 1===c&&(e=!0),2===c&&(e=!1),d.collapse(e),d;if(1==g.nodeType){var b,v=f(g);return v.isControl()&&(b=h.createElement("span"),e?v.before(b):v.after(b),g=b),na(d,g),d.collapse(e),b&&f(b).remove(),d}a=g,c=e?0:g.nodeValue.length}return h=h.createElement("span"),f(a).before(h),na(d,h),d.moveStart("character",c),f(h).remove(),d}function ub(a){function c(a){"tr"==f(a.node).name&&(a.node=a.node.cells[a.offset],a.offset=0)}var h;if(H){if(a.item)return h=V(a.item(0)),h=new M(h),h.selectNode(a.item(0)),h;h=a.parentElement().ownerDocument;var d=sb(a,!0),a=sb(a,!1);return c(d),c(a),h=new M(h),h.setStart(d.node,d.offset),h.setEnd(a.node,a.offset),h}return d=a.startContainer,h=d.ownerDocument||d,h=new M(h),h.setStart(d,a.startOffset),h.setEnd(a.endContainer,a.endOffset),h}function M(a){this.init(a)}function Ra(a){return a.nodeName?new M(a):a.constructor===M?a:ub(a)}function Q(a,c,h){try{a.execCommand(c,!1,h)}catch(d){}}function vb(a,c){var h="";try{h=a.queryCommandValue(c)}catch(d){}return"string"!=typeof h&&(h=""),h}function Sa(a){var c=W(a);return H?a.selection:c.getSelection()}function wb(a){var c,d,h={};return m(a,function(a,g){c=a.split(",");for(var b=0,f=c.length;f>b;b++)d=c[b],h[d]=g}),h}function Ta(a,c){return xb(a,c,"*")||xb(a,c)}function xb(a,c,h){if(h=h||a.name,1!==a.type)return!1;if(c=wb(c),!c[h])return!1;for(var h=c[h].split(","),c=0,d=h.length;d>c;c++){var e=h[c];if("*"===e)return!0;var g=/^(\.?)([^=]+)(?:=([^=]*))?$/.exec(e),b=g[1]?"css":"attr",e=g[2],g=g[3]||"";if(""===g&&""!==a[b](e))return!0;if(""!==g&&a[b](e)===g)return!0}return!1}function Ua(a,c){1==a.type&&(yb(a,c,"*"),yb(a,c))}function yb(a,c,h){if(h=h||a.name,1===a.type&&(c=wb(c),c[h])){for(var h=c[h].split(","),c=!1,d=0,e=h.length;e>d;d++){var g=h[d];if("*"===g){c=!0;break}var b=/^(\.?)([^=]+)(?:=([^=]*))?$/.exec(g),g=b[2];b[1]?(g=ga(g),a[0].style[g]&&(a[0].style[g]="")):a.removeAttr(g)}c&&a.remove(!0)}}function Va(a){for(;a.first();)a=a.first();return a}function ea(a){return 1!=a.type||a.isSingle()?!1:""===a.html().replace(/<[^>]+>/g,"")}function Zb(a,c,h){m(c,function(c,h){"style"!==c&&a.attr(c,h)}),m(h,function(c,h){a.css(c,h)})}function oa(a){this.init(a)}function zb(a){return a.nodeName&&(a=V(a),a=Ra(a).selectNodeContents(a.body).collapse(!1)),new oa(a)}function Wa(a){var c=a.moveEl,h=a.moveFn,d=a.clickEl||c,e=a.beforeDrag,g=[document];(a.iframeFix===i||a.iframeFix)&&f("iframe").each(function(){if(!/^https?:\/\//.test(ia(this.src||"","absolute"))){var a;try{a=Xa(this)}catch(c){}if(a){var h=f(this).pos();f(a).data("pos-x",h.x),f(a).data("pos-y",h.y),g.push(a)}}}),d.mousedown(function(a){function b(a){a.preventDefault();var c=f(V(a.target)),e=R((c.data("pos-x")||0)+a.pageX-p),a=R((c.data("pos-y")||0)+a.pageY-s);h.call(d,r,l,m,o,e,a)}function v(a){a.preventDefault()}function n(a){a.preventDefault(),f(g).unbind("mousemove",b).unbind("mouseup",n).unbind("selectstart",v),i.releaseCapture&&i.releaseCapture()}a.stopPropagation();var i=d.get(),r=t(c.css("left")),l=t(c.css("top")),m=c.width(),o=c.height(),p=a.pageX,s=a.pageY;e&&e(),f(g).mousemove(b).mouseup(n).bind("selectstart",v),i.setCapture&&i.setCapture()})}function S(a){this.init(a)}function Ya(a){return new S(a)}function Xa(a){return a=f(a)[0],a.contentDocument||a.contentWindow.document}function $b(a,c,h,d){var e=[""===Za?"<html>":'<html dir="'+Za+'">','<head><meta charset="utf-8" /><title></title>',"<style>","html {margin:0;padding:0;}","body {margin:0;padding:5px;}",'body, td {font:12px/1.5 "sans serif",tahoma,verdana,helvetica;}',"body, p, div {word-wrap: break-word;}","p {margin:5px 0;}","table {border-collapse:collapse;}","img {border:0;}","noscript {display:none;}","table.ke-zeroborder td {border:1px dotted #AAA;}","img.ke-flash {","	border:1px solid #AAA;","	background-image:url("+a+"common/flash.gif);","	background-position:center center;","	background-repeat:no-repeat;","	width:100px;","	height:100px;","}","img.ke-rm {","	border:1px solid #AAA;","	background-image:url("+a+"common/rm.gif);","	background-position:center center;","	background-repeat:no-repeat;","	width:100px;","	height:100px;","}","img.ke-media {","	border:1px solid #AAA;","	background-image:url("+a+"common/media.gif);","	background-position:center center;","	background-repeat:no-repeat;","	width:100px;","	height:100px;","}","img.ke-anchor {","	border:1px dashed #666;","	width:16px;","	height:16px;","}",".ke-script, .ke-noscript, .ke-display-none {","	display:none;","	font-size:0;","	width:0;","	height:0;","}",".ke-pagebreak {","	border:1px dotted #AAA;","	font-size:0;","	height:2px;","}","</style>"];return Z(h)||(h=[h]),m(h,function(a,c){c&&e.push('<link href="'+c+'" rel="stylesheet" />')}),d&&e.push("<style>"+d+"</style>"),e.push("</head><body "+(c?'class="'+c+'"':"")+"></body></html>"),e.join("\n")}function pa(a,c){if(a.hasVal()){if(c===i){var h=a.val();return h=h.replace(/(<(?:p|p\s[^>]*)>) *(<\/p>)/gi,"")}return a.val(c)}return a.html(c)}function qa(a){this.init(a)}function Ab(a){return new qa(a)}function Bb(a,c){var h=this.get(a);h&&!h.hasClass("ke-disabled")&&c(h)}function Da(a){this.init(a)}function Cb(a){return new Da(a)}function ra(a){this.init(a)}function $a(a){return new ra(a)}function sa(a){this.init(a)}function Db(a){return new sa(a)}function ab(a){this.init(a)}function ta(a){this.init(a)}function Eb(a){return new ta(a)}function bb(a,c){var h=document.getElementsByTagName("head")[0]||(P?document.body:document.documentElement),d=document.createElement("script");h.appendChild(d),d.src=a,d.charset="utf-8",d.onload=d.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState||(c&&c(),d.onload=d.onreadystatechange=null,h.removeChild(d))}}function Fb(a){var c=a.indexOf("?");return c>0?a.substr(0,c):a}function cb(a){for(var c=document.getElementsByTagName("head")[0]||(P?document.body:document.documentElement),h=document.createElement("link"),d=Fb(ia(a,"absolute")),e=f('link[rel="stylesheet"]',c),g=0,b=e.length;b>g;g++)if(Fb(ia(e[g].href,"absolute"))===d)return;c.appendChild(h),h.href=a,h.rel="stylesheet"}function Gb(a,c){return a===i?N:c?void(N[a]=c):N[a]}function Hb(a){var c,h="core";return(c=/^(\w+)\.(\w+)$/.exec(a))&&(h=c[1],a=c[2]),{ns:h,key:a}}function Ib(a,c){if(c=c===i?f.options.langType:c,"string"==typeof a){if(!O[c])return"no language";var h=a.length-1;return"."===a.substr(h)?O[c][a.substr(0,h)]:(h=Hb(a),O[c][h.ns][h.key])}m(a,function(a,h){var g=Hb(a);O[c]||(O[c]={}),O[c][g.ns]||(O[c][g.ns]={}),O[c][g.ns][g.key]=h})}function Ea(a,c){if(!a.collapsed){var a=a.cloneRange().up(),h=a.startContainer,d=a.startOffset;if((X||a.isControl())&&(h=f(h.childNodes[d]))&&"img"==h.name&&c(h))return h}}function ac(){var a=this;f(a.edit.doc).contextmenu(function(c){if(a.menu&&a.hideMenu(),a.useContextmenu){if(0!==a._contextmenus.length){var h=0,d=[];for(m(a._contextmenus,function(){"-"==this.title?d.push(this):this.cond&&this.cond()&&(d.push(this),this.width&&this.width>h)&&(h=this.width)});d.length>0&&"-"==d[0].title;)d.shift();for(;d.length>0&&"-"==d[d.length-1].title;)d.pop();var e=null;if(m(d,function(a){"-"==this.title&&"-"==e.title&&delete d[a],e=this}),d.length>0){c.preventDefault();var g=f(a.edit.iframe).pos(),b=$a({x:g.x+c.clientX,y:g.y+c.clientY,width:h,css:{visibility:"hidden"},shadowMode:a.shadowMode});m(d,function(){this.title&&b.addItem(this)});var g=G(b.doc),v=b.div.height();c.clientY+v>=g.clientHeight-100&&b.pos(b.x,t(b.y)-v),b.div.css("visibility","visible"),a.menu=b}}}else c.preventDefault()})}function bc(){function a(a){for(a=f(a.commonAncestor());a&&(1!=a.type||a.isStyle());)a=a.parent();return a.name}var c=this,h=c.edit.doc,d=c.newlineTag;if(!(o&&"br"!==d||Y&&3>A&&"p"!==d||Pa&&9>A)){var e=u("h1,h2,h3,h4,h5,h6,pre,li"),g=u("p,h1,h2,h3,h4,h5,h6,pre,li,blockquote");f(h).keydown(function(f){if(!(13!=f.which||f.shiftKey||f.ctrlKey||f.altKey)){c.cmd.selection();var b=a(c.cmd.range);"marquee"==b||"select"==b||("br"!==d||e[b]?g[b]||Q(h,"formatblock","<p>"):(f.preventDefault(),c.insertHtml("<br />"+(o&&9>A?"":"​"))))}}),f(h).keyup(function(e){if(!(13!=e.which||e.shiftKey||e.ctrlKey||e.altKey)&&"br"!=d)if(Y){var e=c.cmd.commonAncestor("p"),b=c.cmd.commonAncestor("a");b&&""==b.text()&&(b.remove(!0),c.cmd.range.selectNodeContents(e[0]).collapse(!0),c.cmd.select())}else if(c.cmd.selection(),e=a(c.cmd.range),!("marquee"==e||"select"==e)&&(g[e]||Q(h,"formatblock","<p>"),e=c.cmd.commonAncestor("div"))){for(var b=f("<p></p>"),v=e[0].firstChild;v;){var n=v.nextSibling;b.append(v),v=n}e.before(b),e.remove(),c.cmd.range.selectNodeContents(b[0]),c.cmd.select()}})}}function cc(){var a=this,c=a.edit.doc;f(c).keydown(function(h){if(9==h.which)if(h.preventDefault(),a.afterTab)a.afterTab.call(a,h);else{var h=a.cmd,d=h.range;d.shrink(),d.collapsed&&1==d.startContainer.nodeType&&(d.insertNode(f("@&nbsp;",c)[0]),h.select()),a.insertHtml("&nbsp;&nbsp;&nbsp;&nbsp;")}})}function dc(){var a=this;f(a.edit.textarea[0],a.edit.win).focus(function(c){a.afterFocus&&a.afterFocus.call(a,c)}).blur(function(c){a.afterBlur&&a.afterBlur.call(a,c)})}function T(a){return B(a.replace(/<span [^>]*id="?__kindeditor_bookmark_\w+_\d+__"?[^>]*><\/span>/gi,""))}function Fa(a){return a.replace(/<div[^>]+class="?__kindeditor_paste__"?[^>]*>[\s\S]*?<\/div>/gi,"")}function Jb(a,c){if(0===a.length)a.push(c);else{var h=a[a.length-1];T(c.html)!==T(h.html)&&a.push(c)}}function Kb(a,c){var e,h,g=this.edit,d=g.doc.body;if(0===a.length)return this;g.designMode?(e=this.cmd.range,h=e.createBookmark(!0),h.html=d.innerHTML):h={html:d.innerHTML},Jb(c,h);var b=a.pop();return T(h.html)===T(b.html)&&a.length>0&&(b=a.pop()),g.designMode?(g.html(b.html),b.start&&(e.moveToBookmark(b),this.select())):f(d).html(T(b.html)),this}function ua(a){function c(a,c){ua.prototype[a]===i&&(h[a]=c),h.options[a]=c}var h=this;h.options={},m(a,function(h){c(h,a[h])}),m(f.options,function(a,d){h[a]===i&&c(a,d)});var d=f(h.srcElement||"<textarea/>");h.width||(h.width=d[0].style.width||d.width()),h.height||(h.height=d[0].style.height||d.height()),c("width",l(h.width,h.minWidth)),c("height",l(h.height,h.minHeight)),c("width",s(h.width)),c("height",s(h.height)),ec&&(!fc||534>A)&&(h.designMode=!1),h.srcElement=d,h.initContent="",h.plugin={},h.isCreated=!1,h._handlers={},h._contextmenus=[],h._undoStack=[],h._redoStack=[],h._firstAddBookmark=!0,h.menu=h.contextmenu=null,h.dialogs=[]}function Lb(a,c){function h(a){return m(N,function(c,h){wa(h)&&h.call(a,KindEditor)}),a.create()}if(c=c||{},c.basePath=l(c.basePath,f.basePath),c.themesPath=l(c.themesPath,c.basePath+"themes/"),c.langPath=l(c.langPath,c.basePath+"lang/"),c.pluginsPath=l(c.pluginsPath,c.basePath+"plugins/"),l(c.loadStyleMode,f.options.loadStyleMode)){var d=l(c.themeType,f.options.themeType);cb(c.themesPath+"default/default.css"),cb(c.themesPath+d+"/"+d+".css")}if((d=f(a))&&0!==d.length){if(d.length>1)return d.each(function(){Lb(this,c)}),_instances[0];c.srcElement=d[0];var e=new ua(c);return _instances.push(e),O[e.langType]?h(e):(bb(e.langPath+e.langType+".js?ver="+encodeURIComponent(f.DEBUG?Ga:Ha),function(){h(e)}),e)}}function va(a,c){f(a).each(function(a,d){f.each(_instances,function(a,h){return h&&h.srcElement[0]==d?(c.call(h,a),!1):void 0})})}if(!w.KindEditor){w.console||(w.console={}),console.log||(console.log=function(){});var Ha="4.1.10 (2013-11-23)",p=navigator.userAgent.toLowerCase(),o=p.indexOf("msie")>-1&&-1==p.indexOf("opera"),Yb=-1==p.indexOf("msie")&&p.indexOf("trident")>-1,Y=p.indexOf("gecko")>-1&&-1==p.indexOf("khtml"),X=p.indexOf("applewebkit")>-1,Pa=p.indexOf("opera")>-1,ec=p.indexOf("mobile")>-1,fc=/ipad|iphone|ipod/.test(p),P="CSS1Compat"!=document.compatMode,H=!w.getSelection,A=(p=/(?:msie|firefox|webkit|opera)[\/:\s](\d+)/.exec(p))?p[1]:"0",Ga=(new Date).getTime(),R=Math.round,f={DEBUG:!1,VERSION:Ha,IE:o,GECKO:Y,WEBKIT:X,OPERA:Pa,V:A,TIME:Ga,each:m,isArray:Z,isFunction:wa,inArray:J,inString:xa,trim:B,addUnit:s,removeUnit:t,escape:C,unescape:fa,toCamel:ga,toHex:ya,toMap:u,toArray:Ja,undef:l,invalidUrl:function(a){return!a||/[<>"]/.test(a)},addParam:function(a,c){return a.indexOf("?")>=0?a+"&"+c:a+"?"+c},extend:E,json:eb},lb=u("a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),mb=u("address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul"),kb=u("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),Mb=u("b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u"),gc=u("img,table,input,textarea,button"),La=u("pre,style,script"),Ia=u("html,head,body,td,tr,table,ol,ul,li");u("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");var Ub=u("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),Nb=u("input,button,textarea,select");f.basePath=function(){for(var a,c=document.getElementsByTagName("script"),h=0,d=c.length;d>h;h++)if(a=c[h].src||"",/kindeditor[\w\-\.]*\.js/.test(a))return a.substring(0,a.lastIndexOf("/")+1);return""}(),f.options={designMode:!0,fullscreenMode:!1,filterMode:!0,wellFormatMode:!0,shadowMode:!0,loadStyleMode:!0,basePath:f.basePath,themesPath:f.basePath+"themes/",langPath:f.basePath+"lang/",pluginsPath:f.basePath+"plugins/",themeType:"default",langType:"zh_CN",urlType:"",newlineTag:"p",resizeType:2,syncType:"form",pasteType:2,dialogAlignType:"page",useContextmenu:!0,fullscreenShortcut:!1,bodyClass:"ke-content",indentChar:"	",cssPath:"",cssData:"",minWidth:650,minHeight:100,minChangeSize:50,zIndex:811213,items:["source","|","undo","redo","|","preview","print","template","code","cut","copy","paste","plainpaste","wordpaste","|","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","clearhtml","quickformat","selectall","|","fullscreen","/","formatblock","fontname","fontsize","|","forecolor","hilitecolor","bold","italic","underline","strikethrough","lineheight","removeformat","|","image","multiimage","flash","media","insertfile","table","hr","emoticons","baidumap","pagebreak","anchor","link","unlink","|","about"],noDisableItems:["source","fullscreen"],colorTable:[["#E53333","#E56600","#FF9900","#64451D","#DFC5A4","#FFE500"],["#009900","#006600","#99BB00","#B8D100","#60D978","#00D5FF"],["#337FE5","#003399","#4C33E5","#9933E5","#CC33E5","#EE33EE"],["#FFFFFF","#CCCCCC","#999999","#666666","#333333","#000000"]],fontSizeTable:["9px","10px","12px","14px","16px","18px","24px","32px"],htmlTags:{font:["id","class","color","size","face",".background-color"],span:["id","class",".color",".background-color",".font-size",".font-family",".background",".font-weight",".font-style",".text-decoration",".vertical-align",".line-height"],div:["id","class","align",".border",".margin",".padding",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".background",".font-style",".text-decoration",".vertical-align",".margin-left"],table:["id","class","border","cellspacing","cellpadding","width","height","align","bordercolor",".padding",".margin",".border","bgcolor",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".font-style",".text-decoration",".background",".width",".height",".border-collapse"],"td,th":["id","class","align","valign","width","height","colspan","rowspan","bgcolor",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".font-style",".text-decoration",".vertical-align",".background",".border"],a:["id","class","href","target","name"],embed:["id","class","src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess"],img:["id","class","src","width","height","border","alt","title","align",".width",".height",".border"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["id","class","align",".text-align",".color",".background-color",".font-size",".font-family",".background",".font-weight",".font-style",".text-decoration",".vertical-align",".text-indent",".margin-left"],pre:["id","class"],hr:["id","class",".page-break-after"],"br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":["id","class"],iframe:["id","class","src","frameborder","width","height",".width",".height"]},layout:'<div class="container"><div class="toolbar"></div><div class="edit"></div><div class="statusbar"></div></div>'};var fb=!1,Ob=u("8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222"),p=u("33..40"),db={};m(Ob,function(a,c){db[a]=c}),m(p,function(a,c){db[a]=c});var hc="altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which".split(",");
E(gb,{init:function(a,c){var h=this,d=a.ownerDocument||a.document||a;if(h.event=c,m(hc,function(a,d){h[d]=c[d]}),h.target||(h.target=h.srcElement||d),3===h.target.nodeType&&(h.target=h.target.parentNode),!h.relatedTarget&&h.fromElement&&(h.relatedTarget=h.fromElement===h.target?h.toElement:h.fromElement),null==h.pageX&&null!=h.clientX){var e=d.documentElement,d=d.body;h.pageX=h.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||d&&d.clientLeft||0),h.pageY=h.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||d&&d.clientTop||0)}switch(!h.which&&(h.charCode||0===h.charCode?h.charCode:h.keyCode)&&(h.which=h.charCode||h.keyCode),!h.metaKey&&h.ctrlKey&&(h.metaKey=h.ctrlKey),h.which||h.button===i||(h.which=1&h.button?1:2&h.button?3:4&h.button?2:0),h.which){case 186:h.which=59;break;case 187:case 107:case 43:h.which=61;break;case 189:case 45:h.which=109;break;case 42:h.which=106;break;case 47:h.which=111;break;case 78:h.which=110}h.which>=96&&h.which<=105&&(h.which-=48)},preventDefault:function(){var a=this.event;a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){var a=this.event;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},stop:function(){this.preventDefault(),this.stopPropagation()}});var $="kindeditor_"+Ga,ib=0,v={},Pb=!1;o&&w.attachEvent("onunload",function(){m(v,function(a,c){c.el&&ha(c.el)})}),f.ctrl=Ka,f.ready=function(a){function c(){e||(e=!0,a(KindEditor),Pb=!0)}function h(){if(!e){try{document.documentElement.doScroll("left")}catch(a){return void setTimeout(h,100)}c()}}function d(){"complete"===document.readyState&&c()}if(Pb)a(KindEditor);else{var e=!1;if(document.addEventListener)aa(document,"DOMContentLoaded",c);else if(document.attachEvent){aa(document,"readystatechange",d);var g=!1;try{g=null==w.frameElement}catch(f){}document.documentElement.doScroll&&g&&h()}aa(w,"load",c)}},f.formatUrl=ia,f.formatHtml=U,f.getCssList=ba,f.getAttrList=I,f.mediaType=ob,f.mediaAttrs=pb,f.mediaEmbed=Ma,f.mediaImg=qb,f.clearMsWord=nb,f.tmpl=function(a,c){var h=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return c?h(c):h},p=document.createElement("div"),p.setAttribute("className","t");var Vb="t"!==p.className;f.query=function(a,c){var h=Ca(a,c);return h.length>0?h[0]:null},f.queryAll=Ca,E(D,{init:function(a){for(var a=Z(a)?a:[a],c=0,h=0,d=a.length;d>h;h++)a[h]&&(this[h]=a[h].constructor===D?a[h][0]:a[h],c++);this.length=c,this.doc=V(this[0]),this.name=Oa(this[0]),this.type=this.length>0?this[0].nodeType:null,this.win=W(this[0])},each:function(a){for(var c=0;c<this.length&&a.call(this[c],c,this[c])!==!1;c++);return this},bind:function(a,c){return this.each(function(){aa(this,a,c)}),this},unbind:function(a,c){return this.each(function(){ha(this,a,c)}),this},fire:function(a){return this.length<1?this:(jb(this[0],a),this)},hasAttr:function(a){return this.length<1?!1:!!Ba(this[0],a)},attr:function(a,c){var h=this;return a===i?I(h.outer()):"object"==typeof a?(m(a,function(a,c){h.attr(a,c)}),h):c===i?(c=h.length<1?null:Ba(h[0],a),null===c?"":c):(h.each(function(){Na(this,a,c)}),h)},removeAttr:function(a){return this.each(function(){var c=a;o&&8>A&&"class"==c.toLowerCase()&&(c="className"),Na(this,c,""),this.removeAttribute(c)}),this},get:function(a){return this.length<1?null:this[a||0]},eq:function(a){return this.length<1?null:this[a]?new D(this[a]):null},hasClass:function(a){return this.length<1?!1:xa(a,this[0].className," ")},addClass:function(a){return this.each(function(){xa(a,this.className," ")||(this.className=B(this.className+" "+a))}),this},removeClass:function(a){return this.each(function(){xa(a,this.className," ")&&(this.className=B(this.className.replace(RegExp("(^|\\s)"+a+"(\\s|$)")," ")))}),this},html:function(a){return a===i?this.length<1||1!=this.type?"":U(this[0].innerHTML):(this.each(function(){Wb(this,a)}),this)},text:function(){return this.length<1?"":o?this[0].innerText:this[0].textContent},hasVal:function(){return this.length<1?!1:!!Nb[Oa(this[0])]},val:function(a){return a===i?this.length<1?"":this.hasVal()?this[0].value:this.attr("value"):(this.each(function(){Nb[Oa(this)]?this.value=a:Na(this,"value",a)}),this)},css:function(a,c){var h=this;return a===i?ba(h.attr("style")):"object"==typeof a?(m(a,function(a,c){h.css(a,c)}),h):c===i?h.length<1?"":h[0].style[ga(a)]||Xb(h[0],a)||"":(h.each(function(){this.style[ga(a)]=c}),h)},width:function(a){return a===i?this.length<1?0:this[0].offsetWidth:this.css("width",s(a))},height:function(a){return a===i?this.length<1?0:this[0].offsetHeight:this.css("height",s(a))},opacity:function(a){return this.each(function(){this.style.opacity===i?this.style.filter=1==a?"":"alpha(opacity="+100*a+")":this.style.opacity=1==a?"":a}),this},data:function(a,c){return a="kindeditor_data_"+a,c===i?this.length<1?null:this[0][a]:(this.each(function(){this[a]=c}),this)},pos:function(){var a=this[0],c=0,h=0;if(a)if(a.getBoundingClientRect)a=a.getBoundingClientRect(),h=ca(this.doc),c=a.left+h.x,h=a.top+h.y;else for(;a;)c+=a.offsetLeft,h+=a.offsetTop,a=a.offsetParent;return{x:R(c),y:R(h)}},clone:function(a){return new D(this.length<1?[]:this[0].cloneNode(a))},append:function(a){return this.each(function(){this.appendChild&&this.appendChild(f(a)[0])}),this},appendTo:function(a){return this.each(function(){f(a)[0].appendChild(this)}),this},before:function(a){return this.each(function(){this.parentNode.insertBefore(f(a)[0],this)}),this},after:function(a){return this.each(function(){this.nextSibling?this.parentNode.insertBefore(f(a)[0],this.nextSibling):this.parentNode.appendChild(f(a)[0])}),this},replaceWith:function(a){var c=[];return this.each(function(h,d){ha(d);var e=f(a)[0];d.parentNode.replaceChild(e,d),c.push(e)}),f(c)},empty:function(){return this.each(function(a,c){for(var h=c.firstChild;h&&c.parentNode;){var d=h.nextSibling;h.parentNode.removeChild(h),h=d}}),this},remove:function(a){var c=this;return c.each(function(h,d){if(d.parentNode){if(ha(d),a)for(var e=d.firstChild;e;){var g=e.nextSibling;d.parentNode.insertBefore(e,d),e=g}d.parentNode.removeChild(d),delete c[h]}}),c.length=0,c},show:function(a){return a===i&&(a=this._originDisplay||""),"none"!=this.css("display")?this:this.css("display",a)},hide:function(){return this.length<1?this:(this._originDisplay=this[0].style.display,this.css("display","none"))},outer:function(){if(this.length<1)return"";var a=this.doc.createElement("div");return a.appendChild(this[0].cloneNode(!0)),U(a.innerHTML)},isSingle:function(){return!!kb[this.name]},isInline:function(){return!!lb[this.name]},isBlock:function(){return!!mb[this.name]},isStyle:function(){return!!Mb[this.name]},isControl:function(){return!!gc[this.name]},contains:function(a){return this.length<1?!1:Aa(this[0],f(a)[0])},parent:function(){if(this.length<1)return null;var a=this[0].parentNode;return a?new D(a):null},children:function(){if(this.length<1)return new D([]);for(var a=[],c=this[0].firstChild;c;)(3!=c.nodeType||""!==B(c.nodeValue))&&a.push(c),c=c.nextSibling;return new D(a)},first:function(){var a=this.children();return a.length>0?a.eq(0):null},last:function(){var a=this.children();return a.length>0?a.eq(a.length-1):null},index:function(){if(this.length<1)return-1;for(var a=-1,c=this[0];c;)a++,c=c.previousSibling;return a},prev:function(){if(this.length<1)return null;var a=this[0].previousSibling;return a?new D(a):null},next:function(){if(this.length<1)return null;var a=this[0].nextSibling;return a?new D(a):null},scan:function(a,c){function h(d){for(d=c?d.firstChild:d.lastChild;d;){var e=c?d.nextSibling:d.previousSibling;if(a(d)===!1)return!1;if(h(d)===!1)return!1;d=e}}return this.length<1?void 0:(c=c===i?!0:c,h(this[0]),this)}}),m("blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,change,select,submit,keydown,keypress,keyup,error,contextmenu".split(","),function(a,c){D.prototype[c]=function(a){return a?this.bind(c,a):this.fire(c)}}),p=f,f=function(a,c){function h(a){return a[0]||(a=[]),new D(a)}if(a!==i&&null!==a){if("string"==typeof a){c&&(c=f(c)[0]);var d=a.length;if("@"===a.charAt(0)&&(a=a.substr(1)),a.length!==d||/<.+>/.test(a)){var d=(c?c.ownerDocument||c:document).createElement("div"),e=[];d.innerHTML='<img id="__kindeditor_temp_tag__" width="0" height="0" style="display:none;" />'+a;for(var g=0,b=d.childNodes.length;b>g;g++){var v=d.childNodes[g];"__kindeditor_temp_tag__"!=v.id&&e.push(v)}return h(e)}return h(Ca(a,c))}return a&&a.constructor===D?a:(a.toArray&&(a=a.toArray()),h(Z(a)?a:Ja(arguments)))}},m(p,function(a,c){f[a]=c}),f.NodeClass=D,w.KindEditor=f;var la=0,ka=1,da=2,ma=3,Qb=0;E(M,{init:function(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this.collapsed=!0,this.doc=a},commonAncestor:function(){function a(a){for(var c=[];a;)c.push(a),a=a.parentNode;return c}for(var f,c,h=a(this.startContainer),g=a(this.endContainer),d=0,e=h.length,b=g.length;++d&&(f=h[e-d],c=g[b-d],f&&c&&f===c););return h[e-d+1]},setStart:function(a,c){var h=this.doc;return this.startContainer=a,this.startOffset=c,this.endContainer===h&&(this.endContainer=a,this.endOffset=c),rb(this)},setEnd:function(a,c){var h=this.doc;return this.endContainer=a,this.endOffset=c,this.startContainer===h&&(this.startContainer=a,this.startOffset=c),rb(this)},setStartBefore:function(a){return this.setStart(a.parentNode||this.doc,f(a).index())},setStartAfter:function(a){return this.setStart(a.parentNode||this.doc,f(a).index()+1)},setEndBefore:function(a){return this.setEnd(a.parentNode||this.doc,f(a).index())},setEndAfter:function(a){return this.setEnd(a.parentNode||this.doc,f(a).index()+1)},selectNode:function(a){return this.setStartBefore(a).setEndAfter(a)},selectNodeContents:function(a){var c=f(a);return 3==c.type||c.isSingle()?this.selectNode(a):(c=c.children(),c.length>0?this.setStartBefore(c[0]).setEndAfter(c[c.length-1]):this.setStart(a,0).setEnd(a,0))},collapse:function(a){return a?this.setEnd(this.startContainer,this.startOffset):this.setStart(this.endContainer,this.endOffset)},compareBoundaryPoints:function(a,c){var h=this.get(),d=c.get();if(!H)return h.compareBoundaryPoints(a,d);var e={};if(e[la]="StartToStart",e[ka]="EndToStart",e[da]="EndToEnd",e[ma]="StartToEnd",h=h.compareEndPoints(e[a],d),0!==h)return h;var g,b,v,y;if((a===la||a===ma)&&(g=this.startContainer,v=this.startOffset),(a===ka||a===da)&&(g=this.endContainer,v=this.endOffset),(a===la||a===ka)&&(b=c.startContainer,y=c.startOffset),(a===da||a===ma)&&(b=c.endContainer,y=c.endOffset),g===b)return g=v-y,g>0?1:0>g?-1:0;for(h=b;h&&h.parentNode!==g;)h=h.parentNode;if(h)return f(h).index()>=v?-1:1;for(h=g;h&&h.parentNode!==b;)h=h.parentNode;return h?f(h).index()>=y?1:-1:(h=f(b).next())&&h.contains(g)?1:(h=f(g).next())&&h.contains(b)?-1:void 0},cloneRange:function(){return new M(this.doc).setStart(this.startContainer,this.startOffset).setEnd(this.endContainer,this.endOffset)},toString:function(){var a=this.get();return(H?a.text:a.toString()).replace(/\r\n|\n|\r/g,"")},cloneContents:function(){return Qa(this,!0,!1)},deleteContents:function(){return Qa(this,!1,!0)},extractContents:function(){return Qa(this,!0,!0)},insertNode:function(a){var c,f,h,g=this.startContainer,b=this.startOffset,d=this.endContainer,e=this.endOffset,v=1;return"#document-fragment"===a.nodeName.toLowerCase()&&(c=a.firstChild,f=a.lastChild,v=a.childNodes.length),1==g.nodeType?(h=g.childNodes[b])?(g.insertBefore(a,h),g===d&&(e+=v)):g.appendChild(a):3==g.nodeType&&(0===b?(g.parentNode.insertBefore(a,g),g.parentNode===d&&(e+=v)):b>=g.nodeValue.length?g.nextSibling?g.parentNode.insertBefore(a,g.nextSibling):g.parentNode.appendChild(a):(h=b>0?g.splitText(b):g,g.parentNode.insertBefore(a,h),g===d&&(d=h,e-=b))),c?this.setStartBefore(c).setEndAfter(f):this.selectNode(a),this.compareBoundaryPoints(da,this.cloneRange().setEnd(d,e))>=1?this:this.setEnd(d,e)},surroundContents:function(a){return a.appendChild(this.extractContents()),this.insertNode(a).selectNode(a)},isControl:function(){var a=this.startContainer,c=this.startOffset,h=this.endContainer,d=this.endOffset;return 1==a.nodeType&&a===h&&c+1===d&&f(a.childNodes[c]).isControl()},get:function(a){var c=this.doc;if(!H){c=c.createRange();try{c.setStart(this.startContainer,this.startOffset),c.setEnd(this.endContainer,this.endOffset)}catch(h){}return c}return a&&this.isControl()?(c=c.body.createControlRange(),c.addElement(this.startContainer.childNodes[this.startOffset]),c):(a=this.cloneRange().down(),c=c.body.createTextRange(),c.setEndPoint("StartToStart",tb(a.startContainer,a.startOffset)),c.setEndPoint("EndToStart",tb(a.endContainer,a.endOffset)),c)},html:function(){return f(this.cloneContents()).outer()},down:function(){function a(a,d,e){if(1==a.nodeType&&(a=f(a).children(),0!==a.length)){var h,g,b,v;d>0&&(h=a.eq(d-1)),d<a.length&&(g=a.eq(d)),h&&3==h.type&&(b=h[0],v=b.nodeValue.length),g&&3==g.type&&(b=g[0],v=0),b&&(e?c.setStart(b,v):c.setEnd(b,v))}}var c=this;return a(c.startContainer,c.startOffset,!0),a(c.endContainer,c.endOffset,!1),c},up:function(){function a(a,d,e){3==a.nodeType&&(0===d?e?c.setStartBefore(a):c.setEndBefore(a):d==a.nodeValue.length&&(e?c.setStartAfter(a):c.setEndAfter(a)))}var c=this;return a(c.startContainer,c.startOffset,!0),a(c.endContainer,c.endOffset,!1),c},enlarge:function(a){function c(c,e,g){if(c=f(c),!(3==c.type||Ia[c.name]||!a&&c.isBlock()))if(0===e){for(;!c.prev()&&(e=c.parent(),e&&!Ia[e.name]&&(a||!e.isBlock()));)c=e;g?h.setStartBefore(c[0]):h.setEndBefore(c[0])}else if(e==c.children().length){for(;!c.next()&&(e=c.parent(),e&&!Ia[e.name]&&(a||!e.isBlock()));)c=e;g?h.setStartAfter(c[0]):h.setEndAfter(c[0])}}var h=this;return h.up(),c(h.startContainer,h.startOffset,!0),c(h.endContainer,h.endOffset,!1),h},shrink:function(){for(var a,c=this.collapsed;1==this.startContainer.nodeType&&(a=this.startContainer.childNodes[this.startOffset])&&1==a.nodeType&&!f(a).isSingle();)this.setStart(a,0);if(c)return this.collapse(c);for(;1==this.endContainer.nodeType&&this.endOffset>0&&(a=this.endContainer.childNodes[this.endOffset-1])&&1==a.nodeType&&!f(a).isSingle();)this.setEnd(a,a.childNodes.length);return this},createBookmark:function(a){var c,h=f('<span style="display:none;"></span>',this.doc)[0];return h.id="__kindeditor_bookmark_start_"+Qb++ +"__",this.collapsed||(c=h.cloneNode(!0),c.id="__kindeditor_bookmark_end_"+Qb++ +"__"),c&&this.cloneRange().collapse(!1).insertNode(c).setEndBefore(c),this.insertNode(h).setStartAfter(h),{start:a?"#"+h.id:h,end:c?a?"#"+c.id:c:null}},moveToBookmark:function(a){var c=this.doc,h=f(a.start,c),a=a.end?f(a.end,c):null;return!h||h.length<1?this:(this.setStartBefore(h[0]),h.remove(),a&&a.length>0?(this.setEndBefore(a[0]),a.remove()):this.collapse(!0),this)},dump:function(){}}),f.RangeClass=M,f.range=Ra,f.START_TO_START=la,f.START_TO_END=ka,f.END_TO_END=da,f.END_TO_START=ma,E(oa,{init:function(a){var c=a.doc;this.doc=c,this.win=W(c),this.sel=Sa(c),this.range=a},selection:function(a){var c,h=this.doc;c=Sa(h);var d;try{d=c.rangeCount>0?c.getRangeAt(0):c.createRange()}catch(e){}return c=!H||d&&(d.item||d.parentElement().ownerDocument===h)?d:null,this.sel=Sa(h),c?(this.range=Ra(c),"html"==f(this.range.startContainer).name&&this.range.selectNodeContents(h.body).collapse(!1),this):(a&&this.range.selectNodeContents(h.body).collapse(!1),this)},select:function(a){var c,a=l(a,!0),h=this.sel,g=this.range.cloneRange().shrink(),d=g.startContainer,e=g.startOffset,b=V(d),v=this.win,y=!1;if(a&&1==d.nodeType&&g.collapsed){if(H){h=f("<span>&nbsp;</span>",b),g.insertNode(h[0]),c=b.body.createTextRange();try{c.moveToElementText(h[0])}catch(n){}return c.collapse(!1),c.select(),h.remove(),v.focus(),this}X&&(a=d.childNodes,f(d).isInline()||e>0&&f(a[e-1]).isInline()||a[e]&&f(a[e]).isInline())&&(g.insertNode(b.createTextNode("​")),y=!0)}if(H)try{c=g.get(!0),c.select()}catch(i){}else y&&g.collapse(!1),c=g.get(!0),h.removeAllRanges(),h.addRange(c),b!==document&&(g=f(c.endContainer).pos(),v.scrollTo(g.x,g.y));return v.focus(),this},wrap:function(a){var c,h=this.range;if(c=f(a,this.doc),h.collapsed)return h.shrink(),h.insertNode(c[0]).selectNodeContents(c[0]),this;if(c.isBlock()){for(var d=a=c.clone(!0);d.first();)d=d.first();return d.append(h.extractContents()),h.insertNode(a[0]).selectNode(a[0]),this}h.enlarge();var e=h.createBookmark(),a=h.commonAncestor(),g=!1;return f(a).scan(function(a){if(g||a!=e.start){if(g){if(a==e.end)return!1;var d,h=f(a);e:{for(d=h;d&&"body"!=d.name;){if(La[d.name]||"div"==d.name&&d.hasClass("ke-script")){d=!0;break e}d=d.parent()}d=!1}if(!d&&3==h.type&&B(a.nodeValue).length>0){for(var n;(n=h.parent())&&n.isStyle()&&1==n.children().length;)h=n;if(n=c,n=n.clone(!0),3==h.type)Va(n).append(h.clone(!1)),h.replaceWith(n);else{for(var i,a=h;(i=h.first())&&1==i.children().length;)h=i;for(i=h.first(),h=h.doc.createDocumentFragment();i;)h.appendChild(i[0]),i=i.next();i=a.clone(!0),d=Va(i);for(var r=i,l=!1;n;){for(;r;)r.name===n.name&&(Zb(r,n.attr(),n.css()),l=!0),r=r.first();l||d.append(n.clone(!1)),l=!1,n=n.first()}n=i,h.firstChild&&Va(n).append(h),a.replaceWith(n)}}}}else g=!0}),h.moveToBookmark(e),this},split:function(a,c){for(var n,h=this.range,d=h.doc,e=h.cloneRange().collapse(a),g=e.startContainer,b=e.startOffset,v=3==g.nodeType?g.parentNode:g,y=!1;v&&v.parentNode;){if(n=f(v),c){if(!n.isStyle())break;if(!Ta(n,c))break}else if(Ia[n.name])break;y=!0,v=v.parentNode}return y&&(d=d.createElement("span"),h.cloneRange().collapse(!a).insertNode(d),a?e.setStartBefore(v.firstChild).setEnd(g,b):e.setStart(g,b).setEndAfter(v.lastChild),g=e.extractContents(),b=g.firstChild,y=g.lastChild,a?(e.insertNode(g),h.setStartAfter(y).setEndBefore(d)):(v.appendChild(g),h.setStartBefore(d).setEndBefore(b)),e=d.parentNode,e==h.endContainer&&(v=f(d).prev(),g=f(d).next(),v&&g&&3==v.type&&3==g.type?h.setEnd(v[0],v[0].nodeValue.length):a||h.setEnd(h.endContainer,h.endOffset-1)),e.removeChild(d)),this},remove:function(a){var c=this.doc,h=this.range;if(h.enlarge(),0===h.startOffset){for(var e,d=f(h.startContainer);(e=d.parent())&&e.isStyle()&&1==e.children().length;)d=e;h.setStart(d[0],0),d=f(h.startContainer),d.isBlock()&&Ua(d,a),(d=d.parent())&&d.isBlock()&&Ua(d,a)}if(h.collapsed)return this.split(!0,a),c=h.startContainer,d=h.startOffset,d>0&&(e=f(c.childNodes[d-1]))&&ea(e)&&(e.remove(),h.setStart(c,d-1)),(d=f(c.childNodes[d]))&&ea(d)&&d.remove(),ea(c)&&(h.startBefore(c),c.remove()),h.collapse(!0),this;this.split(!0,a),this.split(!1,a);var g=c.createElement("span"),b=c.createElement("span");h.cloneRange().collapse(!1).insertNode(b),h.cloneRange().collapse(!0).insertNode(g);var v=[],y=!1;f(h.commonAncestor()).scan(function(a){if(y||a!=g){if(a==b)return!1;y&&v.push(a)}else y=!0}),f(g).remove(),f(b).remove(),c=h.startContainer,d=h.startOffset,e=h.endContainer;var n=h.endOffset;if(d>0){var i=f(c.childNodes[d-1]);i&&ea(i)&&(i.remove(),h.setStart(c,d-1),c==e&&h.setEnd(e,n-1)),(d=f(c.childNodes[d]))&&ea(d)&&(d.remove(),c==e&&h.setEnd(e,n-1))}return(c=f(e.childNodes[h.endOffset]))&&ea(c)&&c.remove(),c=h.createBookmark(!0),m(v,function(c,h){Ua(f(h),a)}),h.moveToBookmark(c),this},commonNode:function(a){function c(c){for(var h=c;c;){if(Ta(f(c),a))return f(c);c=c.parentNode}for(;h&&(h=h.lastChild);)if(Ta(f(h),a))return f(h);return null}var h=this.range,d=h.endContainer,h=h.endOffset,e=3==d.nodeType||0===h?d:d.childNodes[h-1],g=c(e);return g?g:(1==e.nodeType||3==d.nodeType&&0===h)&&(d=f(e).prev())?c(d):null},commonAncestor:function(a){function c(c){for(;c;){if(1==c.nodeType&&c.tagName.toLowerCase()===a)return c;c=c.parentNode}return null}var h=this.range,d=h.startContainer,e=h.startOffset,g=h.endContainer,h=h.endOffset,g=3==g.nodeType||0===h?g:g.childNodes[h-1],d=c(3==d.nodeType||0===e?d:d.childNodes[e-1]),e=c(g);return d&&e&&d===e?f(d):null},state:function(a){var c=this.doc,h=!1;try{h=c.queryCommandState(a)}catch(d){}return h},val:function(a){var c=this.doc,a=a.toLowerCase(),h="";return"fontfamily"===a||"fontname"===a?(h=vb(c,"fontname"),h=h.replace(/['"]/g,""),h.toLowerCase()):"formatblock"===a?(h=vb(c,a),""===h&&(a=this.commonNode({"h1,h2,h3,h4,h5,h6,p,div,pre,address":"*"}))&&(h=a.name),"Normal"===h&&(h="p"),h.toLowerCase()):"fontsize"===a?((a=this.commonNode({"*":".font-size"}))&&(h=a.css("font-size")),h.toLowerCase()):"forecolor"===a?((a=this.commonNode({"*":".color"}))&&(h=a.css("color")),h=ya(h),""===h&&(h="default"),h.toLowerCase()):"hilitecolor"===a?((a=this.commonNode({"*":".background-color"}))&&(h=a.css("background-color")),h=ya(h),""===h&&(h="default"),h.toLowerCase()):h},toggle:function(a,c){return this.commonNode(c)?this.remove(c):this.wrap(a),this.select()},bold:function(){return this.toggle("<strong></strong>",{span:".font-weight=bold",strong:"*",b:"*"})},italic:function(){return this.toggle("<em></em>",{span:".font-style=italic",em:"*",i:"*"})},underline:function(){return this.toggle("<u></u>",{span:".text-decoration=underline",u:"*"})},strikethrough:function(){return this.toggle("<s></s>",{span:".text-decoration=line-through",s:"*"})},forecolor:function(a){return this.wrap('<span style="color:'+a+';"></span>').select()},hilitecolor:function(a){return this.wrap('<span style="background-color:'+a+';"></span>').select()},fontsize:function(a){return this.wrap('<span style="font-size:'+a+';"></span>').select()},fontname:function(a){return this.fontfamily(a)},fontfamily:function(a){return this.wrap('<span style="font-family:'+a+';"></span>').select()},removeformat:function(){var a={"*":".font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent"};return m(Mb,function(c){a[c]="*"}),this.remove(a),this.select()},inserthtml:function(a,c){function h(a,c){var c='<img id="__kindeditor_temp_tag__" width="0" height="0" style="display:none;" />'+c,h=a.get();h.item?h.item(0).outerHTML=c:h.pasteHTML(c);var d=a.doc.getElementById("__kindeditor_temp_tag__");d.parentNode.removeChild(d),h=ub(h),a.setEnd(h.endContainer,h.endOffset),a.collapse(!1),e.select(!1)}function d(a,c){var h=a.doc,d=h.createDocumentFragment();f("@"+c,h).each(function(){d.appendChild(this)}),a.deleteContents(),a.insertNode(d),a.collapse(!1),e.select(!1)}var e=this,g=e.range;if(""===a)return e;if(H&&c){try{h(g,a)}catch(b){d(g,a)}return e}return d(g,a),e},hr:function(){return this.inserthtml("<hr />")},print:function(){return this.win.print(),this},insertimage:function(a,c,h,d,e,g){return c=l(c,""),l(e,0),a='<img src="'+C(a)+'" data-ke-src="'+C(a)+'" ',h&&(a+='width="'+C(h)+'" '),d&&(a+='height="'+C(d)+'" '),c&&(a+='title="'+C(c)+'" '),g&&(a+='align="'+C(g)+'" '),a+='alt="'+C(c)+'" ',a+="/>",this.inserthtml(a)},createlink:function(a,c){function h(a,c,h){f(a).attr("href",c).attr("data-ke-src",c),h?f(a).attr("target",h):f(a).removeAttr("target")}var d=this.doc,e=this.range;this.select();var g=this.commonNode({a:"*"});if(g&&!e.isControl()&&(e.selectNode(g.get()),this.select()),g='<a href="'+C(a)+'" data-ke-src="'+C(a)+'" ',c&&(g+=' target="'+C(c)+'"'),e.collapsed)return g+=">"+C(a)+"</a>",this.inserthtml(g);if(e.isControl()){var b=f(e.startContainer.childNodes[e.startOffset]);return g+="></a>",b.after(f(g,d)),b.next().append(b),e.selectNode(b[0]),this.select()}var g=e.startContainer,b=e.startOffset,v=e.endContainer,e=e.endOffset;return 1==g.nodeType&&g===v&&b+1===e&&(e=g.childNodes[b],"a"==e.nodeName.toLowerCase())?(h(e,a,c),this):(Q(d,"createlink","__kindeditor_temp_url__"),f('a[href="__kindeditor_temp_url__"]',d).each(function(){h(this,a,c)}),this)},unlink:function(){var a=this.doc,c=this.range;if(this.select(),c.collapsed){var h=this.commonNode({a:"*"});h&&(c.selectNode(h.get()),this.select()),Q(a,"unlink",null),X&&"img"===f(c.startContainer).name&&(a=f(c.startContainer).parent(),"a"===a.name&&a.remove(!0))}else Q(a,"unlink",null);return this}}),m("formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,indent,outdent,subscript,superscript".split(","),function(a,c){oa.prototype[c]=function(a){return this.select(),Q(this.doc,c,a),H&&J(c,"justifyleft,justifycenter,justifyright,justifyfull".split(","))>=0&&this.selection(),(!H||J(c,"formatblock,selectall,insertorderedlist,insertunorderedlist".split(","))>=0)&&this.selection(),this}}),m("cut,copy,paste".split(","),function(a,c){oa.prototype[c]=function(){if(!this.doc.queryCommandSupported(c))throw"not supported";return this.select(),Q(this.doc,c,null),this}}),f.CmdClass=oa,f.cmd=zb,E(S,{init:function(a){var c=this;if(c.name=a.name||"",c.doc=a.doc||document,c.win=W(c.doc),c.x=s(a.x),c.y=s(a.y),c.z=a.z,c.width=s(a.width),c.height=s(a.height),c.div=f('<div style="display:block;"></div>'),c.options=a,c._alignEl=a.alignEl,c.width&&c.div.css("width",c.width),c.height&&c.div.css("height",c.height),c.z&&c.div.css({position:"absolute",left:c.x,top:c.y,"z-index":c.z}),c.z&&(c.x===i||c.y===i)&&c.autoPos(c.width,c.height),a.cls&&c.div.addClass(a.cls),a.shadowMode&&c.div.addClass("ke-shadow"),a.css&&c.div.css(a.css),a.src?f(a.src).replaceWith(c.div):f(c.doc.body).append(c.div),a.html&&c.div.html(a.html),a.autoScroll)if(o&&7>A||P){var h=ca();f(c.win).bind("scroll",function(){var a=ca(),e=a.x-h.x,a=a.y-h.y;c.pos(t(c.x)+e,t(c.y)+a,!1)})}else c.div.css("position","fixed")},pos:function(a,c,h){return h=l(h,!0),null!==a&&(a=0>a?0:s(a),this.div.css("left",a),h)&&(this.x=a),null!==c&&(c=0>c?0:s(c),this.div.css("top",c),h)&&(this.y=c),this},autoPos:function(a,c){var h=t(a)||0,d=t(c)||0,e=ca();if(this._alignEl){var g=f(this._alignEl),b=g.pos(),h=R(g[0].clientWidth/2-h/2),d=R(g[0].clientHeight/2-d/2);x=0>h?b.x:b.x+h,y=0>d?b.y:b.y+d}else b=G(this.doc),x=R(e.x+(b.clientWidth-h)/2),y=R(e.y+(b.clientHeight-d)/2);return o&&7>A||P||(x-=e.x,y-=e.y),this.pos(x,y)},remove:function(){var a=this;return(o&&7>A||P)&&f(a.win).unbind("scroll"),a.div.remove(),m(a,function(c){a[c]=null}),this},show:function(){return this.div.show(),this},hide:function(){return this.div.hide(),this},draggable:function(a){var c=this,a=a||{};return a.moveEl=c.div,a.moveFn=function(a,d,e,h,f,g){(a+=f)<0&&(a=0),(d+=g)<0&&(d=0),c.pos(a,d)},Wa(a),c}}),f.WidgetClass=S,f.widget=Ya;var Za="";(p=document.getElementsByTagName("html"))&&(Za=p[0].dir),E(qa,S,{init:function(a){function c(){var c=Xa(h.iframe);c.open(),v&&(c.domain=document.domain),c.write($b(d,e,g,b)),c.close(),h.win=h.iframe[0].contentWindow,h.doc=c;var y=zb(c);h.afterChange(function(){y.selection()}),X&&f(c).click(function(a){"img"===f(a.target).name&&(y.selection(!0),y.range.selectNode(a.target),y.select())}),o&&(h._mousedownHandler=function(){var a=y.range.cloneRange();a.shrink(),a.isControl()&&h.blur()},f(document).mousedown(h._mousedownHandler),f(c).keydown(function(a){if(8==a.which){y.selection();var c=y.range;c.isControl()&&(c.collapse(!0),f(c.startContainer.childNodes[c.startOffset]).remove(),a.preventDefault())}})),h.cmd=y,h.html(pa(h.srcElement)),o?(c.body.disabled=!0,c.body.contentEditable=!0,c.body.removeAttribute("disabled")):c.designMode="on",a.afterCreate&&a.afterCreate.call(h)}var h=this;qa.parent.init.call(h,a),h.srcElement=f(a.srcElement),h.div.addClass("ke-edit"),h.designMode=l(a.designMode,!0),h.beforeGetHtml=a.beforeGetHtml,h.beforeSetHtml=a.beforeSetHtml,h.afterSetHtml=a.afterSetHtml;var d=l(a.themesPath,""),e=a.bodyClass,g=a.cssPath,b=a.cssData,v="res:"!=location.protocol&&location.host.replace(/:\d+/,"")!==document.domain,y="document.open();"+(v?'document.domain="'+document.domain+'";':"")+"document.close();",y=o?' src="javascript:void(function(){'+encodeURIComponent(y)+'}())"':"";h.iframe=f('<iframe class="ke-edit-iframe" hidefocus="true" frameborder="0"'+y+"></iframe>").css("width","100%"),h.textarea=f('<textarea class="ke-edit-textarea" hidefocus="true"></textarea>').css("width","100%"),h.tabIndex=isNaN(parseInt(a.tabIndex,10))?h.srcElement.attr("tabindex"):parseInt(a.tabIndex,10),h.iframe.attr("tabindex",h.tabIndex),h.textarea.attr("tabindex",h.tabIndex),h.width&&h.setWidth(h.width),h.height&&h.setHeight(h.height),h.designMode?h.textarea.hide():h.iframe.hide(),v&&h.iframe.bind("load",function(){h.iframe.unbind("load"),o?c():setTimeout(c,0)}),h.div.append(h.iframe),h.div.append(h.textarea),h.srcElement.hide(),!v&&c()},setWidth:function(a){return this.width=a=s(a),this.div.css("width",a),this},setHeight:function(a){return this.height=a=s(a),this.div.css("height",a),this.iframe.css("height",a),(o&&8>A||P)&&(a=s(t(a)-2)),this.textarea.css("height",a),this},remove:function(){var a=this.doc;f(a.body).unbind(),f(a).unbind(),f(this.win).unbind(),this._mousedownHandler&&f(document).unbind("mousedown",this._mousedownHandler),pa(this.srcElement,this.html()),this.srcElement.show(),a.write(""),this.iframe.unbind(),this.textarea.unbind(),qa.parent.remove.call(this)},html:function(a,c){var h=this.doc;return this.designMode?(h=h.body,a===i?(a=c?"<!doctype html><html>"+h.parentNode.innerHTML+"</html>":h.innerHTML,this.beforeGetHtml&&(a=this.beforeGetHtml(a)),Y&&"<br />"==a&&(a=""),a):(this.beforeSetHtml&&(a=this.beforeSetHtml(a)),o&&A>=9&&(a=a.replace(/(<.*?checked=")checked(".*>)/gi,"$1$2")),f(h).html(a),this.afterSetHtml&&this.afterSetHtml(),this)):a===i?this.textarea.val():(this.textarea.val(a),this)},design:function(a){return(a===i?!this.designMode:a)?this.designMode||(a=this.html(),this.designMode=!0,this.html(a),this.textarea.hide(),this.iframe.show()):this.designMode&&(a=this.html(),this.designMode=!1,this.html(a),this.iframe.hide(),this.textarea.show()),this.focus()},focus:function(){return this.designMode?this.win.focus():this.textarea[0].focus(),this},blur:function(){if(o){var a=f('<input type="text" style="float:left;width:0;height:0;padding:0;margin:0;border:0;" value="" />',this.div);this.div.append(a),a[0].focus(),a.remove()}else this.designMode?this.win.blur():this.textarea[0].blur();return this},afterChange:function(a){function c(c){setTimeout(function(){a(c)},1)}var h=this.doc,d=h.body;return f(h).keyup(function(c){!c.ctrlKey&&!c.altKey&&db[c.which]&&a(c)}),f(h).mouseup(a).contextmenu(a),f(this.win).blur(a),f(d).bind("paste",c),f(d).bind("cut",c),this}}),f.EditClass=qa,f.edit=Ab,f.iframeDoc=Xa,E(Da,S,{init:function(a){function c(a){return a=f(a),a.hasClass("ke-outline")?a:a.hasClass("ke-toolbar-icon")?a.parent():void 0}function h(a,h){var d=c(a.target);!d||d.hasClass("ke-disabled")||d.hasClass("ke-selected")||d[h]("ke-on")}var d=this;Da.parent.init.call(d,a),d.disableMode=l(a.disableMode,!1),d.noDisableItemMap=u(l(a.noDisableItems,[])),d._itemMap={},d.div.addClass("ke-toolbar").bind("contextmenu,mousedown,mousemove",function(a){a.preventDefault()}).attr("unselectable","on"),d.div.mouseover(function(a){h(a,"addClass")}).mouseout(function(a){h(a,"removeClass")}).click(function(a){var h=c(a.target);h&&!h.hasClass("ke-disabled")&&d.options.click.call(this,a,h.attr("data-name"))})},get:function(a){return this._itemMap[a]?this._itemMap[a]:this._itemMap[a]=f("span.ke-icon-"+a,this.div).parent()},select:function(a){return Bb.call(this,a,function(a){a.addClass("ke-selected")}),self},unselect:function(a){return Bb.call(this,a,function(a){a.removeClass("ke-selected").removeClass("ke-on")}),self},enable:function(a){return(a=a.get?a:this.get(a))&&(a.removeClass("ke-disabled"),a.opacity(1)),this},disable:function(a){return(a=a.get?a:this.get(a))&&(a.removeClass("ke-selected").addClass("ke-disabled"),a.opacity(.5)),this},disableAll:function(a,c){var h=this,d=h.noDisableItemMap;return c&&(d=u(c)),(a===i?!h.disableMode:a)?(f("span.ke-outline",h.div).each(function(){var a=f(this),c=a[0].getAttribute("data-name",2);d[c]||h.disable(a)}),h.disableMode=!0):(f("span.ke-outline",h.div).each(function(){var a=f(this),c=a[0].getAttribute("data-name",2);d[c]||h.enable(a)}),h.disableMode=!1),h}}),f.ToolbarClass=Da,f.toolbar=Cb,E(ra,S,{init:function(a){a.z=a.z||811213,ra.parent.init.call(this,a),this.centerLineMode=l(a.centerLineMode,!0),this.div.addClass("ke-menu").bind("click,mousedown",function(a){a.stopPropagation()
}).attr("unselectable","on")},addItem:function(a){if("-"!==a.title){var c=f('<div class="ke-menu-item" unselectable="on"></div>'),h=f('<div class="ke-inline-block ke-menu-item-left"></div>'),d=f('<div class="ke-inline-block ke-menu-item-right"></div>'),e=s(a.height),g=l(a.iconClass,"");this.div.append(c),e&&(c.css("height",e),d.css("line-height",e));var b;return this.centerLineMode&&(b=f('<div class="ke-inline-block ke-menu-item-center"></div>'),e&&b.css("height",e)),c.mouseover(function(){f(this).addClass("ke-menu-item-on"),b&&b.addClass("ke-menu-item-center-on")}).mouseout(function(){f(this).removeClass("ke-menu-item-on"),b&&b.removeClass("ke-menu-item-center-on")}).click(function(c){a.click.call(f(this)),c.stopPropagation()}).append(h),b&&c.append(b),c.append(d),a.checked&&(g="ke-icon-checked"),""!==g&&h.html('<span class="ke-inline-block ke-toolbar-icon ke-toolbar-icon-url '+g+'"></span>'),d.html(a.title),this}this.div.append(f('<div class="ke-menu-separator"></div>'))},remove:function(){return this.options.beforeRemove&&this.options.beforeRemove.call(this),f(".ke-menu-item",this.div[0]).unbind(),ra.parent.remove.call(this),this}}),f.MenuClass=ra,f.menu=$a,E(sa,S,{init:function(a){a.z=a.z||811213,sa.parent.init.call(this,a);var c=a.colors||[["#E53333","#E56600","#FF9900","#64451D","#DFC5A4","#FFE500"],["#009900","#006600","#99BB00","#B8D100","#60D978","#00D5FF"],["#337FE5","#003399","#4C33E5","#9933E5","#CC33E5","#EE33EE"],["#FFFFFF","#CCCCCC","#999999","#666666","#333333","#000000"]];this.selectedColor=(a.selectedColor||"").toLowerCase(),this._cells=[],this.div.addClass("ke-colorpicker").bind("click,mousedown",function(a){a.stopPropagation()}).attr("unselectable","on"),a=this.doc.createElement("table"),this.div.append(a),a.className="ke-colorpicker-table",a.cellPadding=0,a.cellSpacing=0,a.border=0;var h=a.insertRow(0),d=h.insertCell(0);d.colSpan=c[0].length,this._addAttr(d,"","ke-colorpicker-cell-top");for(var e=0;e<c.length;e++)for(var h=a.insertRow(e+1),g=0;g<c[e].length;g++)d=h.insertCell(g),this._addAttr(d,c[e][g],"ke-colorpicker-cell")},_addAttr:function(a,c,h){var d=this,a=f(a).addClass(h);d.selectedColor===c.toLowerCase()&&a.addClass("ke-colorpicker-cell-selected"),a.attr("title",c||d.options.noColor),a.mouseover(function(){f(this).addClass("ke-colorpicker-cell-on")}),a.mouseout(function(){f(this).removeClass("ke-colorpicker-cell-on")}),a.click(function(a){a.stop(),d.options.click.call(f(this),c)}),c?a.append(f('<div class="ke-colorpicker-cell-color" unselectable="on"></div>').css("background-color",c)):a.html(d.options.noColor),f(a).attr("unselectable","on"),d._cells.push(a)},remove:function(){return m(this._cells,function(){this.unbind()}),sa.parent.remove.call(this),this}}),f.ColorPickerClass=sa,f.colorpicker=Db,E(ab,{init:function(a){var c=f(a.button),h=a.fieldName||"file",d=a.url||"",e=c.val(),g=a.extraParams||{},b=c[0].className||"",v=a.target||"kindeditor_upload_iframe_"+(new Date).getTime();a.afterError=a.afterError||function(a){alert(a)};var i,y=[];for(i in g)y.push('<input type="hidden" name="'+i+'" value="'+g[i]+'" />');h=['<div class="ke-inline-block '+b+'">',a.target?"":'<iframe name="'+v+'" style="display:none;"></iframe>',a.form?'<div class="ke-upload-area">':'<form class="ke-upload-area ke-form" method="post" enctype="multipart/form-data" target="'+v+'" action="'+d+'">','<span class="ke-button-common">',y.join(""),'<input type="button" class="ke-button-common ke-button" value="'+e+'" />',"</span>",'<input type="file" class="ke-upload-file" name="'+h+'" tabindex="-1" />',a.form?"</div>":"</form>","</div>"].join(""),h=f(h,c.doc),c.hide(),c.before(h),this.div=h,this.button=c,this.iframe=a.target?f('iframe[name="'+v+'"]'):f("iframe",h),this.form=a.form?f(a.form):f("form",h),this.fileBox=f(".ke-upload-file",h),c=a.width||f(".ke-button-common",h).width(),f(".ke-upload-area",h).width(c),this.options=a},submit:function(){var a=this,c=a.iframe;return c.bind("load",function(){c.unbind();var h=document.createElement("form");a.fileBox.before(h),f(h).append(a.fileBox),h.reset(),f(h).remove(!0);var g,h=f.iframeDoc(c),d=h.getElementsByTagName("pre")[0],e="",e=d?d.innerHTML:h.body.innerHTML,e=fa(e);c[0].src="javascript:false";try{g=f.json(e)}catch(b){a.options.afterError.call(a,"<!doctype html><html>"+h.body.parentNode.innerHTML+"</html>")}g&&a.options.afterUpload.call(a,g)}),a.form[0].submit(),a},remove:function(){return this.fileBox&&this.fileBox.unbind(),this.iframe.remove(),this.div.remove(),this.button.show(),this}}),f.UploadButtonClass=ab,f.uploadbutton=function(a){return new ab(a)},E(ta,S,{init:function(a){var c=l(a.shadowMode,!0);a.z=a.z||811213,a.shadowMode=!1,a.autoScroll=l(a.autoScroll,!0),ta.parent.init.call(this,a);var h=a.title,d=f(a.body,this.doc),e=a.previewBtn,g=a.yesBtn,b=a.noBtn,v=a.closeBtn,y=l(a.showMask,!0);this.div.addClass("ke-dialog").bind("click,mousedown",function(a){a.stopPropagation()});var i=f('<div class="ke-dialog-content"></div>').appendTo(this.div);o&&7>A?this.iframeMask=f('<iframe src="about:blank" class="ke-dialog-shadow"></iframe>').appendTo(this.div):c&&f('<div class="ke-dialog-shadow"></div>').appendTo(this.div),c=f('<div class="ke-dialog-header"></div>'),i.append(c),c.html(h),this.closeIcon=f('<span class="ke-dialog-icon-close" title="'+v.name+'"></span>').click(v.click),c.append(this.closeIcon),this.draggable({clickEl:c,beforeDrag:a.beforeDrag}),a=f('<div class="ke-dialog-body"></div>'),i.append(a),a.append(d);var q=f('<div class="ke-dialog-footer"></div>');(e||g||b)&&i.append(q),m([{btn:e,name:"preview"},{btn:g,name:"yes"},{btn:b,name:"no"}],function(){if(this.btn){var a=this.btn,a=a||{},c=a.name||"",h=f('<span class="ke-button-common ke-button-outer" title="'+c+'"></span>'),c=f('<input class="ke-button-common ke-button" type="button" value="'+c+'" />');a.click&&c.click(a.click),h.append(c),h.addClass("ke-dialog-"+this.name),q.append(h)}}),this.height&&a.height(t(this.height)-c.height()-q.height()),this.div.width(this.div.width()),this.div.height(this.div.height()),this.mask=null,y&&(d=G(this.doc),this.mask=Ya({x:0,y:0,z:this.z-1,cls:"ke-dialog-mask",width:Math.max(d.scrollWidth,d.clientWidth),height:Math.max(d.scrollHeight,d.clientHeight)})),this.autoPos(this.div.width(),this.div.height()),this.footerDiv=q,this.bodyDiv=a,this.headerDiv=c,this.isLoading=!1},setMaskIndex:function(a){this.mask.div.css("z-index",a)},showLoading:function(a){var a=l(a,""),c=this.bodyDiv;return this.loading=f('<div class="ke-dialog-loading"><div class="ke-inline-block ke-dialog-loading-content" style="margin-top:'+Math.round(c.height()/3)+'px;">'+a+"</div></div>").width(c.width()).height(c.height()).css("top",this.headerDiv.height()+"px"),c.css("visibility","hidden").after(this.loading),this.isLoading=!0,this},hideLoading:function(){return this.loading&&this.loading.remove(),this.bodyDiv.css("visibility","visible"),this.isLoading=!1,this},remove:function(){return this.options.beforeRemove&&this.options.beforeRemove.call(this),this.mask&&this.mask.remove(),this.iframeMask&&this.iframeMask.remove(),this.closeIcon.unbind(),f("input",this.div).unbind(),f("button",this.div).unbind(),this.footerDiv.unbind(),this.bodyDiv.unbind(),this.headerDiv.unbind(),f("iframe",this.div).each(function(){f(this).remove()}),ta.parent.remove.call(this),this}}),f.DialogClass=ta,f.dialog=Eb,f.tabs=function(a){var c=Ya(a),h=c.remove,d=a.afterSelect,a=c.div,e=[];a.addClass("ke-tabs").bind("contextmenu,mousedown,mousemove",function(a){a.preventDefault()});var g=f('<ul class="ke-tabs-ul ke-clearfix"></ul>');return a.append(g),c.add=function(a){var c=f('<li class="ke-tabs-li">'+a.title+"</li>");c.data("tab",a),e.push(c),g.append(c)},c.selectedIndex=0,c.select=function(a){c.selectedIndex=a,m(e,function(h,d){d.unbind(),h===a?(d.addClass("ke-tabs-li-selected"),f(d.data("tab").panel).show("")):(d.removeClass("ke-tabs-li-selected").removeClass("ke-tabs-li-on").mouseover(function(){f(this).addClass("ke-tabs-li-on")}).mouseout(function(){f(this).removeClass("ke-tabs-li-on")}).click(function(){c.select(h)}),f(d.data("tab").panel).hide())}),d&&d.call(c,a)},c.remove=function(){m(e,function(){this.remove()}),g.remove(),h.call(c)},c},f.loadScript=bb,f.loadStyle=cb,f.ajax=function(a,c,h,d,e){var h=h||"GET",e=e||"json",g=w.XMLHttpRequest?new w.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(g.open(h,a,!0),g.onreadystatechange=function(){if(4==g.readyState&&200==g.status&&c){var a=B(g.responseText);"json"==e&&(a=eb(a)),c(a)}},"POST"==h){var f=[];m(d,function(a,c){f.push(encodeURIComponent(a)+"="+encodeURIComponent(c))});try{g.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(b){}g.send(f.join("&"))}else g.send(null)};var N={},O={};ua.prototype={lang:function(a){return Ib(a,this.langType)},loadPlugin:function(a,c){var h=this;return N[a]?wa(N[a])?(N[a].call(h,KindEditor),c&&c.call(h),h):(setTimeout(function(){h.loadPlugin(a,c)},100),h):(N[a]="loading",bb(h.pluginsPath+a+"/"+a+".js?ver="+encodeURIComponent(f.DEBUG?Ga:Ha),function(){setTimeout(function(){N[a]&&h.loadPlugin(a,c)},0)}),h)},handler:function(a,c){var h=this;return h._handlers[a]||(h._handlers[a]=[]),wa(c)?(h._handlers[a].push(c),h):(m(h._handlers[a],function(){c=this.call(h,c)}),c)},clickToolbar:function(a,c){var h=this,d="clickToolbar"+a;return c===i?h._handlers[d]?h.handler(d):(h.loadPlugin(a,function(){h.handler(d)}),h):h.handler(d,c)},updateState:function(){var a=this;return m("justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,subscript,superscript,bold,italic,underline,strikethrough".split(","),function(c,h){a.cmd.state(h)?a.toolbar.select(h):a.toolbar.unselect(h)}),a},addContextmenu:function(a){return this._contextmenus.push(a),this},afterCreate:function(a){return this.handler("afterCreate",a)},beforeRemove:function(a){return this.handler("beforeRemove",a)},beforeGetHtml:function(a){return this.handler("beforeGetHtml",a)},beforeSetHtml:function(a){return this.handler("beforeSetHtml",a)},afterSetHtml:function(a){return this.handler("afterSetHtml",a)},create:function(){function a(){0===y.height()?setTimeout(a,100):c.resize(d,e,!1)}var c=this,h=c.fullscreenMode;if(c.isCreated)return c;if(c.srcElement.data("kindeditor"))return c;c.srcElement.data("kindeditor","true"),G().style.overflow=h?"hidden":"";var d=h?G().clientWidth+"px":c.width,e=h?G().clientHeight+"px":c.height;(o&&8>A||P)&&(e=s(t(e)+2));var g=c.container=f(c.layout);h?f(document.body).append(g):c.srcElement.before(g);var b=f(".toolbar",g),v=f(".edit",g),y=c.statusbar=f(".statusbar",g);g.removeClass("container").addClass("ke-container ke-container-"+c.themeType).css("width",d),h?(g.css({position:"absolute",left:0,top:0,"z-index":811211}),Y||(c._scrollPos=ca()),w.scrollTo(0,0),f(document.body).css({height:"1px",overflow:"hidden"}),f(document.body.parentNode).css("overflow","hidden"),c._fullscreenExecuted=!0):(c._fullscreenExecuted&&(f(document.body).css({height:"",overflow:""}),f(document.body.parentNode).css("overflow","")),c._scrollPos&&w.scrollTo(c._scrollPos.x,c._scrollPos.y));var i=[];f.each(c.items,function(a,h){"|"==h?i.push('<span class="ke-inline-block ke-separator"></span>'):"/"==h?i.push('<div class="ke-hr"></div>'):(i.push('<span class="ke-outline" data-name="'+h+'" title="'+c.lang(h)+'" unselectable="on">'),i.push('<span class="ke-toolbar-icon ke-toolbar-icon-url ke-icon-'+h+'" unselectable="on"></span></span>'))});var b=c.toolbar=Cb({src:b,html:i.join(""),noDisableItems:c.noDisableItems,click:function(a,h){if(a.stop(),c.menu){var d=c.menu.name;if(c.hideMenu(),d===h)return}c.clickToolbar(h)}}),l=t(e)-b.div.height(),m=c.edit=Ab({height:l>0&&t(e)>c.minHeight?l:c.minHeight,src:v,srcElement:c.srcElement,designMode:c.designMode,themesPath:c.themesPath,bodyClass:c.bodyClass,cssPath:c.cssPath,cssData:c.cssData,beforeGetHtml:function(a){return a=c.beforeGetHtml(a),a=T(Fa(a)),U(a,c.filterMode?c.htmlTags:null,c.urlType,c.wellFormatMode,c.indentChar)},beforeSetHtml:function(a){return a=U(a,c.filterMode?c.htmlTags:null,"",!1),c.beforeSetHtml(a)},afterSetHtml:function(){c.edit=m=this,c.afterSetHtml()},afterCreate:function(){if(c.edit=m=this,c.cmd=m.cmd,c._docMousedownFn=function(){c.menu&&c.hideMenu()},f(m.doc,document).mousedown(c._docMousedownFn),ac.call(c),bc.call(c),cc.call(c),dc.call(c),m.afterChange(function(){m.designMode&&(c.updateState(),c.addBookmark(),c.options.afterChange&&c.options.afterChange.call(c))}),m.textarea.keyup(function(a){!a.ctrlKey&&!a.altKey&&Ob[a.which]&&c.options.afterChange&&c.options.afterChange.call(c)}),c.readonlyMode&&c.readonly(),c.isCreated=!0,""===c.initContent&&(c.initContent=c.html()),c._undoStack.length>0){var a=c._undoStack.pop();a.start&&(c.html(a.html),m.cmd.range.moveToBookmark(a),c.select())}c.afterCreate(),c.options.afterCreate&&c.options.afterCreate.call(c)}});return y.removeClass("statusbar").addClass("ke-statusbar").append('<span class="ke-inline-block ke-statusbar-center-icon"></span>').append('<span class="ke-inline-block ke-statusbar-right-icon"></span>'),c._fullscreenResizeHandler&&(f(w).unbind("resize",c._fullscreenResizeHandler),c._fullscreenResizeHandler=null),a(),h?(c._fullscreenResizeHandler=function(){c.isCreated&&c.resize(G().clientWidth,G().clientHeight,!1)},f(w).bind("resize",c._fullscreenResizeHandler),b.select("fullscreen"),y.first().css("visibility","hidden"),y.last().css("visibility","hidden")):(Y&&f(w).bind("scroll",function(){c._scrollPos=ca()}),c.resizeType>0?Wa({moveEl:g,clickEl:y,moveFn:function(a,h,d,e,g,f){e+=f,c.resize(null,e)}}):y.first().css("visibility","hidden"),2===c.resizeType?Wa({moveEl:g,clickEl:y.last(),moveFn:function(a,h,d,e,g,f){d+=g,e+=f,c.resize(d,e)}}):y.last().css("visibility","hidden")),c},remove:function(){var a=this;return a.isCreated?(a.beforeRemove(),a.srcElement.data("kindeditor",""),a.menu&&a.hideMenu(),m(a.dialogs,function(){a.hideDialog()}),f(document).unbind("mousedown",a._docMousedownFn),a.toolbar.remove(),a.edit.remove(),a.statusbar.last().unbind(),a.statusbar.unbind(),a.container.remove(),a.container=a.toolbar=a.edit=a.menu=null,a.dialogs=[],a.isCreated=!1,a):a},resize:function(a,c,h){return h=l(h,!0),a&&(/%/.test(a)||(a=t(a),a=a<this.minWidth?this.minWidth:a),this.container.css("width",s(a)),h)&&(this.width=s(a)),c&&(c=t(c),editHeight=t(c)-this.toolbar.div.height()-this.statusbar.height(),editHeight=editHeight<this.minHeight?this.minHeight:editHeight,this.edit.setHeight(editHeight),h)&&(this.height=s(c)),this},select:function(){return this.isCreated&&this.cmd.select(),this},html:function(a){return a===i?this.isCreated?this.edit.html():pa(this.srcElement):(this.isCreated?this.edit.html(a):pa(this.srcElement,a),this.isCreated&&this.cmd.selection(),this)},fullHtml:function(){return this.isCreated?this.edit.html(i,!0):""},text:function(a){return a===i?B(this.html().replace(/<(?!img|embed).*?>/gi,"").replace(/&nbsp;/gi," ")):this.html(C(a))},isEmpty:function(){return""===B(this.text().replace(/\r\n|\n|\r/,""))},isDirty:function(){return B(this.initContent.replace(/\r\n|\n|\r|t/g,""))!==B(this.html().replace(/\r\n|\n|\r|t/g,""))},selectedHtml:function(){var a=this.isCreated?this.cmd.range.html():"";return a=T(Fa(a))},count:function(a){return a=(a||"html").toLowerCase(),"html"===a?this.html().length:"text"===a?this.text().replace(/<(?:img|embed).*?>/gi,"K").replace(/\r\n|\n|\r/g,"").length:0},exec:function(a){var a=a.toLowerCase(),c=this.cmd,h=J(a,"selectall,copy,paste,print".split(","))<0;return h&&this.addBookmark(!1),c[a].apply(c,Ja(arguments,1)),h&&(this.updateState(),this.addBookmark(!1),this.options.afterChange&&this.options.afterChange.call(this)),this},insertHtml:function(a,c){return this.isCreated?(a=this.beforeSetHtml(a),this.exec("inserthtml",a,c),this):this},appendHtml:function(a){return this.html(this.html()+a),this.isCreated&&(a=this.cmd,a.range.selectNodeContents(a.doc.body).collapse(!1),a.select()),this},sync:function(){return pa(this.srcElement,this.html()),this},focus:function(){return this.isCreated?this.edit.focus():this.srcElement[0].focus(),this},blur:function(){return this.isCreated?this.edit.blur():this.srcElement[0].blur(),this},addBookmark:function(a){var a=l(a,!0),c=this.edit,h=c.doc.body,d=Fa(h.innerHTML);return a&&this._undoStack.length>0&&Math.abs(d.length-T(this._undoStack[this._undoStack.length-1].html).length)<this.minChangeSize?this:(c.designMode&&!this._firstAddBookmark?(c=this.cmd.range,a=c.createBookmark(!0),a.html=Fa(h.innerHTML),c.moveToBookmark(a)):a={html:d},this._firstAddBookmark=!1,Jb(this._undoStack,a),this)},undo:function(){return Kb.call(this,this._undoStack,this._redoStack)},redo:function(){return Kb.call(this,this._redoStack,this._undoStack)},fullscreen:function(a){return this.fullscreenMode=a===i?!this.fullscreenMode:a,this.addBookmark(!1),this.remove().create()},readonly:function(a){var a=l(a,!0),c=this,h=c.edit,d=h.doc;c.designMode?c.toolbar.disableAll(a,[]):m(c.noDisableItems,function(){c.toolbar[a?"disable":"enable"](this)}),o?d.body.contentEditable=!a:d.designMode=a?"off":"on",h.textarea[0].disabled=a},createMenu:function(a){var c=this.toolbar.get(a.name),h=c.pos();return a.x=h.x,a.y=h.y+c.height(),a.z=this.options.zIndex,a.shadowMode=l(a.shadowMode,this.shadowMode),a.selectedColor!==i?(a.cls="ke-colorpicker-"+this.themeType,a.noColor=this.lang("noColor"),this.menu=Db(a)):(a.cls="ke-menu-"+this.themeType,a.centerLineMode=!1,this.menu=$a(a)),this.menu},hideMenu:function(){return this.menu.remove(),this.menu=null,this},hideContextmenu:function(){return this.contextmenu.remove(),this.contextmenu=null,this},createDialog:function(a){var c=this;if(a.z=c.options.zIndex,a.shadowMode=l(a.shadowMode,c.shadowMode),a.closeBtn=l(a.closeBtn,{name:c.lang("close"),click:function(){c.hideDialog(),o&&c.cmd&&c.cmd.select()}}),a.noBtn=l(a.noBtn,{name:c.lang(a.yesBtn?"no":"close"),click:function(){c.hideDialog(),o&&c.cmd&&c.cmd.select()}}),"page"!=c.dialogAlignType&&(a.alignEl=c.container),a.cls="ke-dialog-"+c.themeType,c.dialogs.length>0){var h=c.dialogs[c.dialogs.length-1];c.dialogs[0].setMaskIndex(h.z+2),a.z=h.z+3,a.showMask=!1}return a=Eb(a),c.dialogs.push(a),a},hideDialog:function(){return this.dialogs.length>0&&this.dialogs.pop().remove(),this.dialogs.length>0&&this.dialogs[0].setMaskIndex(this.dialogs[this.dialogs.length-1].z-1),this},errorDialog:function(a){var c=this.createDialog({width:750,title:this.lang("uploadError"),body:'<div style="padding:10px 20px;"><iframe frameborder="0" style="width:708px;height:400px;"></iframe></div>'}),c=f("iframe",c.div),h=f.iframeDoc(c);return h.open(),h.write(a),h.close(),f(h.body).css("background-color","#FFF"),c[0].contentWindow.focus(),this}},_instances=[],f.remove=function(a){va(a,function(a){this.remove(),_instances.splice(a,1)})},f.sync=function(a){va(a,function(){this.sync()})},f.html=function(a,c){va(a,function(){this.html(c)})},f.insertHtml=function(a,c){va(a,function(){this.insertHtml(c)})},f.appendHtml=function(a,c){va(a,function(){this.appendHtml(c)})},o&&7>A&&Q(document,"BackgroundImageCache",!0),f.EditorClass=ua,f.editor=function(a){return new ua(a)},f.create=Lb,f.instances=_instances,f.plugin=Gb,f.lang=Ib,Gb("core",function(a){var c=this,h={undo:"Z",redo:"Y",bold:"B",italic:"I",underline:"U",print:"P",selectall:"A"};if(c.afterSetHtml(function(){c.options.afterChange&&c.options.afterChange.call(c)}),c.afterCreate(function(){if("form"==c.syncType){for(var h=a(c.srcElement),d=!1;h=h.parent();)if("form"==h.name){d=!0;break}if(d){h.bind("submit",function(){c.sync(),a(w).bind("unload",function(){c.edit.textarea.remove()})});var f=a('[type="reset"]',h);f.click(function(){c.html(c.initContent),c.cmd.selection()}),c.beforeRemove(function(){h.unbind(),f.unbind()})}}}),c.clickToolbar("source",function(){c.edit.designMode?(c.toolbar.disableAll(!0),c.edit.design(!1),c.toolbar.select("source")):(c.toolbar.disableAll(!1),c.edit.design(!0),c.toolbar.unselect("source"),Y?setTimeout(function(){c.cmd.selection()},0):c.cmd.selection()),c.designMode=c.edit.designMode}),c.afterCreate(function(){c.designMode||c.toolbar.disableAll(!0).select("source")}),c.clickToolbar("fullscreen",function(){c.fullscreen()}),c.fullscreenShortcut){var d=!1;c.afterCreate(function(){if(a(c.edit.doc,c.edit.textarea).keyup(function(a){27==a.which&&setTimeout(function(){c.fullscreen()},0)}),d){if(o&&!c.designMode)return;c.focus()}d||(d=!0)})}m("undo,redo".split(","),function(a,d){h[d]&&c.afterCreate(function(){Ka(this.edit.doc,h[d],function(){c.clickToolbar(d)})}),c.clickToolbar(d,function(){c[d]()})}),c.clickToolbar("formatblock",function(){var a=c.lang("formatblock.formatBlock"),h={h1:28,h2:24,h3:18,H4:14,p:12},d=c.cmd.val("formatblock"),f=c.createMenu({name:"formatblock",width:"en"==c.langType?200:150});m(a,function(a,e){var i="font-size:"+h[a]+"px;";"h"===a.charAt(0)&&(i+="font-weight:bold;"),f.addItem({title:'<span style="'+i+'" unselectable="on">'+e+"</span>",height:h[a]+12,checked:d===a||d===e,click:function(){c.select().exec("formatblock","<"+a+">").hideMenu()}})})}),c.clickToolbar("fontname",function(){var a=c.cmd.val("fontname"),h=c.createMenu({name:"fontname",width:150});m(c.lang("fontname.fontName"),function(d,f){h.addItem({title:'<span style="font-family: '+d+';" unselectable="on">'+f+"</span>",checked:a===d.toLowerCase()||a===f.toLowerCase(),click:function(){c.exec("fontname",d).hideMenu()}})})}),c.clickToolbar("fontsize",function(){var a=c.cmd.val("fontsize"),h=c.createMenu({name:"fontsize",width:150});m(c.fontSizeTable,function(d,f){h.addItem({title:'<span style="font-size:'+f+';" unselectable="on">'+f+"</span>",height:t(f)+12,checked:a===f,click:function(){c.exec("fontsize",f).hideMenu()}})})}),m("forecolor,hilitecolor".split(","),function(a,h){c.clickToolbar(h,function(){c.createMenu({name:h,selectedColor:c.cmd.val(h)||"default",colors:c.colorTable,click:function(a){c.exec(h,a).hideMenu()}})})}),m("cut,copy,paste".split(","),function(a,h){c.clickToolbar(h,function(){c.focus();try{c.exec(h,null)}catch(a){alert(c.lang(h+"Error"))}})}),c.clickToolbar("about",function(){var a='<div style="margin:20px;"><div>KindEditor '+Ha+'</div><div>Copyright &copy; <a href="http://www.kindsoft.net/" target="_blank">kindsoft.net</a> All rights reserved.</div></div>';c.createDialog({name:"about",width:350,title:c.lang("about"),body:a})}),c.plugin.getSelectedLink=function(){return c.cmd.commonAncestor("a")},c.plugin.getSelectedImage=function(){return Ea(c.edit.cmd.range,function(a){return!/^ke-\w+$/i.test(a[0].className)})},c.plugin.getSelectedFlash=function(){return Ea(c.edit.cmd.range,function(a){return"ke-flash"==a[0].className})},c.plugin.getSelectedMedia=function(){return Ea(c.edit.cmd.range,function(a){return"ke-media"==a[0].className||"ke-rm"==a[0].className})},c.plugin.getSelectedAnchor=function(){return Ea(c.edit.cmd.range,function(a){return"ke-anchor"==a[0].className})},m("link,image,flash,media,anchor".split(","),function(a,h){var d=h.charAt(0).toUpperCase()+h.substr(1);m("edit,delete".split(","),function(a,e){c.addContextmenu({title:c.lang(e+d),click:function(){c.loadPlugin(h,function(){c.plugin[h][e](),c.hideMenu()})},cond:c.plugin["getSelected"+d],width:150,iconClass:"edit"==e?"ke-icon-"+h:i})}),c.addContextmenu({title:"-"})}),c.plugin.getSelectedTable=function(){return c.cmd.commonAncestor("table")},c.plugin.getSelectedRow=function(){return c.cmd.commonAncestor("tr")},c.plugin.getSelectedCell=function(){return c.cmd.commonAncestor("td")},m("prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,rowsplit,colsplit,coldelete,rowdelete,insert,delete".split(","),function(a,h){var d=J(h,["prop","delete"])<0?c.plugin.getSelectedCell:c.plugin.getSelectedTable;c.addContextmenu({title:c.lang("table"+h),click:function(){c.loadPlugin("table",function(){c.plugin.table[h](),c.hideMenu()})},cond:d,width:170,iconClass:"ke-icon-table"+h})}),c.addContextmenu({title:"-"}),m("selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,indent,outdent,subscript,superscript,hr,print,bold,italic,underline,strikethrough,removeformat,unlink".split(","),function(a,d){h[d]&&c.afterCreate(function(){Ka(this.edit.doc,h[d],function(){c.cmd.selection(),c.clickToolbar(d)})}),c.clickToolbar(d,function(){c.focus().exec(d,null)})}),c.afterCreate(function(){function h(){f.range.moveToBookmark(g),f.select(),X&&(a("div."+l,i).each(function(){a(this).after("<br />").remove(!0)}),a("span.Apple-style-span",i).remove(!0),a("span.Apple-tab-span",i).remove(!0),a("span[style]",i).each(function(){"nowrap"==a(this).css("white-space")&&a(this).remove(!0)}),a("meta",i).remove());var d=i[0].innerHTML;i.remove(),""!==d&&(X&&(d=d.replace(/(<br>)\1/gi,"$1")),2===c.pasteType&&(d=d.replace(/(<(?:p|p\s[^>]*)>) *(<\/p>)/gi,""),/schemas-microsoft-com|worddocument|mso-\w+/i.test(d)?d=nb(d,c.filterMode?c.htmlTags:a.options.htmlTags):(d=U(d,c.filterMode?c.htmlTags:null),d=c.beforeSetHtml(d))),1===c.pasteType&&(d=d.replace(/&nbsp;/gi," "),d=d.replace(/\n\s*\n/g,"\n"),d=d.replace(/<br[^>]*>/gi,"\n"),d=d.replace(/<\/p><p[^>]*>/gi,"\n"),d=d.replace(/<[^>]+>/g,""),d=d.replace(/ {2}/g," &nbsp;"),"p"==c.newlineTag?/\n/.test(d)&&(d=d.replace(/^/,"<p>").replace(/$/,"<br /></p>").replace(/\n/g,"<br /></p><p>")):d=d.replace(/\n/g,"<br />$&")),c.insertHtml(d,!0))}var f,g,i,d=c.edit.doc,l="__kindeditor_paste__",m=!1;a(d.body).bind("paste",function(p){if(0===c.pasteType)p.stop();else if(!m){if(m=!0,a("div."+l,d).remove(),f=c.cmd.selection(),g=f.range.createBookmark(),i=a('<div class="'+l+'"></div>',d).css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",left:"-1981px",top:a(g.start).pos().y+"px","white-space":"nowrap"}),a(d.body).append(i),o){var s=f.range.get(!0);s.moveToElementText(i[0]),s.select(),s.execCommand("paste"),p.preventDefault()}else f.range.selectNodeContents(i[0]),f.select();setTimeout(function(){h(),m=!1},0)}})}),c.beforeGetHtml(function(a){return o&&8>=A&&(a=a.replace(/<div\s+[^>]*data-ke-input-tag="([^"]*)"[^>]*>([\s\S]*?)<\/div>/gi,function(a,c){return unescape(c)}),a=a.replace(/(<input)((?:\s+[^>]*)?>)/gi,function(a,c,h){return/\s+type="[^"]+"/i.test(a)?a:c+' type="text"'+h})),a.replace(/(<(?:noscript|noscript\s[^>]*)>)([\s\S]*?)(<\/noscript>)/gi,function(a,c,h,d){return c+fa(h).replace(/\s+/g," ")+d}).replace(/<img[^>]*class="?ke-(flash|rm|media)"?[^>]*>/gi,function(a){var a=I(a),c=ba(a.style||""),h=pb(a["data-ke-tag"]),d=l(c.width,""),c=l(c.height,"");return/px/i.test(d)&&(d=t(d)),/px/i.test(c)&&(c=t(c)),h.width=l(a.width,d),h.height=l(a.height,c),Ma(h)}).replace(/<img[^>]*class="?ke-anchor"?[^>]*>/gi,function(a){return a=I(a),'<a name="'+unescape(a["data-ke-name"])+'"></a>'}).replace(/<div\s+[^>]*data-ke-script-attr="([^"]*)"[^>]*>([\s\S]*?)<\/div>/gi,function(a,c,h){return"<script"+unescape(c)+">"+unescape(h)+"</script>"}).replace(/<div\s+[^>]*data-ke-noscript-attr="([^"]*)"[^>]*>([\s\S]*?)<\/div>/gi,function(a,c,h){return"<noscript"+unescape(c)+">"+unescape(h)+"</noscript>"}).replace(/(<[^>]*)data-ke-src="([^"]*)"([^>]*>)/gi,function(a,c,h){return a=a.replace(/(\s+(?:href|src)=")[^"]*(")/i,function(a,c,d){return c+fa(h)+d}),a=a.replace(/\s+data-ke-src="[^"]*"/i,"")}).replace(/(<[^>]+\s)data-ke-(on\w+="[^"]*"[^>]*>)/gi,function(a,c,h){return c+h})}),c.beforeSetHtml(function(a){return o&&8>=A&&(a=a.replace(/<input[^>]*>|<(select|button)[^>]*>[\s\S]*?<\/\1>/gi,function(a){var c=I(a);return"none"==ba(c.style||"").display?'<div class="ke-display-none" data-ke-input-tag="'+escape(a)+'"></div>':a})),a.replace(/<embed[^>]*type="([^"]+)"[^>]*>(?:<\/embed>)?/gi,function(a){return a=I(a),a.src=l(a.src,""),a.width=l(a.width,0),a.height=l(a.height,0),qb(c.themesPath+"common/blank.gif",a)}).replace(/<a[^>]*name="([^"]+)"[^>]*>(?:<\/a>)?/gi,function(a){var h=I(a);return h.href!==i?a:'<img class="ke-anchor" src="'+c.themesPath+'common/anchor.gif" data-ke-name="'+escape(h.name)+'" />'}).replace(/<script([^>]*)>([\s\S]*?)<\/script>/gi,function(a,c,h){return'<div class="ke-script" data-ke-script-attr="'+escape(c)+'">'+escape(h)+"</div>"}).replace(/<noscript([^>]*)>([\s\S]*?)<\/noscript>/gi,function(a,c,h){return'<div class="ke-noscript" data-ke-noscript-attr="'+escape(c)+'">'+escape(h)+"</div>"}).replace(/(<[^>]*)(href|src)="([^"]*)"([^>]*>)/gi,function(a,c,h,d,e){return a.match(/\sdata-ke-src="[^"]*"/i)?a:a=c+h+'="'+d+'" data-ke-src="'+C(d)+'"'+e}).replace(/(<[^>]+\s)(on\w+="[^"]*"[^>]*>)/gi,function(a,c,h){return c+"data-ke-"+h}).replace(/<table[^>]*\s+border="0"[^>]*>/gi,function(a){return a.indexOf("ke-zeroborder")>=0?a:Sb(a,"ke-zeroborder")})})})}}(window)});