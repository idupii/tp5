KindEditor.plugin("baidumap",function(a){var c=this,h="baidumap",v=c.lang(h+"."),k=a.undef(c.mapWidth,558),g=a.undef(c.mapHeight,360);c.clickToolbar(h,function(){function b(){y=B[0].contentWindow,w=a.iframeDoc(B)}var y,w,D=['<div style="padding:10px 20px;">','<div class="ke-header">','<div class="ke-left">',v.address+' <input id="kindeditor_plugin_map_address" name="address" class="ke-input-text" value="" style="width:200px;" /> ','<span class="ke-button-common ke-button-outer">','<input type="button" name="searchBtn" class="ke-button-common ke-button" value="'+v.search+'" />',"</span>","</div>",'<div class="ke-right">','<input type="checkbox" id="keInsertDynamicMap" name="insertDynamicMap" value="1" /> <label for="keInsertDynamicMap">'+v.insertDynamicMap+"</label>","</div>",'<div class="ke-clearfix"></div>',"</div>",'<div class="ke-map" style="width:'+k+"px;height:"+g+'px;"></div>',"</div>"].join(""),I=c.createDialog({name:h,width:k+42,title:c.lang(h),body:D,yesBtn:{name:c.lang("yes"),click:function(){var a=y.map,h=a.getCenter(),v=h.lng+","+h.lat,b=a.getZoom(),w=[U[0].checked?c.pluginsPath+"baidumap/index.html":"http://api.map.baidu.com/staticimage","?center="+encodeURIComponent(v),"&zoom="+encodeURIComponent(b),"&width="+k,"&height="+g,"&markers="+encodeURIComponent(v),"&markerStyles="+encodeURIComponent("l,A")].join("");U[0].checked?c.insertHtml('<iframe src="'+w+'" frameborder="0" style="width:'+(k+2)+"px;height:"+(g+2)+'px;"></iframe>'):c.exec("insertimage",w),c.hideDialog().focus()}},beforeRemove:function(){R.remove(),w&&w.write(""),B.remove()}}),C=I.div,M=a('[name="address"]',C),R=a('[name="searchBtn"]',C),U=a('[name="insertDynamicMap"]',I.div),B=a('<iframe class="ke-textarea" frameborder="0" src="'+c.pluginsPath+'baidumap/map.html" style="width:'+k+"px;height:"+g+'px;"></iframe>');B.bind("load",function(){B.unbind("load"),a.IE?b():setTimeout(b,0)}),a(".ke-map",C).replaceWith(B),R.click(function(){y.search(M.val())})})});